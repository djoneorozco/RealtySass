<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Tue Feb 10 2026 02:34:24 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="69813f96ae2f57a7b399c51f" data-wf-site="697e270fb126ef5fe6610167" lang="en">
<head>
  <meta charset="utf-8">
  <title>Financial Planner Single</title>
  <meta content="Financial Planner Single" property="og:title">
  <meta content="Financial Planner Single" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/realtysass-a30aee.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","PT Serif:400,400italic,700,700italic","Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic","Barlow Condensed:300,400,500,600,700","DM Sans:300,400,500,600,700","Gilda Display:300,400,500,600,700","Inter Tight:300,400,500,600,700"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.svg" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.svg" rel="apple-touch-icon">
</head>
<body>
  <section class="section-261"></section>
  <section class="section-270">
    <div class="code-embed-3 w-embed w-script"><!--  RealtySaSS • Affordability Planner (Embed #1) — FAD skin update
     ✅ Update: Remove Fiduciary Guidance
     ✅ Update: Keep 2-column layout under KPIs
     ✅ Update: Replace RIGHT “Visual Budget” with Section 4) Home Scenario (What-If)
     ✅ Everything else stays the same (logic + look)
 -->
      <style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
  /* ============================================================
    //#1 FULL-BLEED FAD SHELL (visual only)
  ============================================================ */
  #va-fullscreen-shell{
    width:100vw;
    position:relative;
    left:50%;
    right:50%;
    margin-left:-50vw;
    margin-right:-50vw;
    background:
      radial-gradient(1200px 420px at 12% -10%, rgba(142,243,197,.10), transparent 55%),
      radial-gradient(900px 420px at 88% -10%, rgba(106,167,255,.10), transparent 55%),
      linear-gradient(180deg, #0b0e1a, #080a14 60%, #070911);
    border-top:1px solid rgba(255,255,255,.06);
    border-bottom:1px solid rgba(255,255,255,.06);
    overflow:hidden;
  }
  #va-fullscreen-shell::before{
    content:"";
    position:absolute; inset:0;
    background:
      repeating-linear-gradient(90deg, rgba(255,255,255,.035) 0 1px, transparent 1px 46px),
      repeating-linear-gradient(0deg, rgba(255,255,255,.028) 0 1px, transparent 1px 46px);
    opacity:.16;
    pointer-events:none;
    mask-image: radial-gradient(120% 70% at 50% 0%, #000 55%, transparent 100%);
  }
  /* ============================================================
    //#2 THEME TOKENS (kept) + FAD TUNING
  ============================================================ */
  #va-planner{
    --bg:#0b0e1a;
    --panel:#101426;
    --panel2:#0f1324;
    --card:#121936;
    --ink:#e9ecff;
    --muted:#a8b0d6;
    --accent:#6aa7ff;
    --accent2:#8ef3c5;
    --ok:#55d399;
    --warn:#f9c74f;
    --bad:#ff6b6b;
    --stroke:rgba(255,255,255,.08);
    --stroke2:rgba(255,255,255,.12);
    --shadow:0 24px 48px rgba(0,0,0,.80), inset 0 1px 0 rgba(255,255,255,.05);
    --shadowSoft:0 14px 28px rgba(0,0,0,.35);
    --radius:18px;
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--ink);
  }
  #va-planner *, #va-planner *::before, #va-planner *::after{ box-sizing:border-box; }
  /* ============================================================
    //#3 WRAP + TOP STRIP (FAD-like)
  ============================================================ */
  #va-planner .va-wrap{
    width:100%;
    max-width:1400px;
    margin:0 auto;
    padding:18px 16px 56px;
    min-width:0;
    position:relative;
  }
  #va-planner .va-topbar{
    position:sticky;
    top:0;
    z-index:40;
    margin:0 0 14px;
    padding:10px;
    border-radius:16px;
    border:1px solid rgba(255,255,255,.08);
    background:rgba(12,14,25,.58);
    backdrop-filter:blur(10px) saturate(1.12);
    -webkit-backdrop-filter:blur(10px) saturate(1.12);
    box-shadow:0 18px 40px rgba(0,0,0,.55);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    overflow:hidden;
  }
  #va-planner .va-topbar::before{
    content:"";
    position:absolute; inset:-2px;
    background:
      radial-gradient(900px 260px at 12% 0%, rgba(142,243,197,.12), transparent 55%),
      radial-gradient(900px 260px at 88% 0%, rgba(106,167,255,.10), transparent 55%);
    pointer-events:none;
  }
  #va-planner .va-topbar > *{ position:relative; }
  #va-planner .va-topLeft{
    display:flex; align-items:center; gap:10px; min-width:0;
  }
  #va-planner .va-pill{
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding:9px 12px;
    border-radius:999px;
    background:rgba(12,14,25,.65);
    border:1px solid rgba(255,255,255,.10);
    box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
    white-space:nowrap;
  }
  #va-planner .va-pill small{
    color:var(--muted);
    font-size:11px;
    letter-spacing:.10em;
    text-transform:uppercase;
  }
  #va-planner .va-pill b{
    font-weight:900;
    letter-spacing:.2px;
  }
  #va-planner .va-miniDot{ width:10px; height:10px; border-radius:50%; background:var(--ok); }
  #va-planner .va-topRight{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
    justify-content:flex-end;
  }
  #va-planner .va-topBtn{
    appearance:none;
    border:none;
    cursor:pointer;
    border-radius:999px;
    padding:10px 14px;
    font-weight:900;
    letter-spacing:.02em;
    background:radial-gradient(120% 120% at 25% 15%, var(--accent2), var(--accent));
    color:#050712;
    box-shadow:0 14px 30px rgba(0,0,0,.60);
    transition:transform .12s ease, filter .12s ease;
  }
  #va-planner .va-topBtn:hover{ transform:translateY(-1px); filter:brightness(1.03); }
  #va-planner .va-topBtn:active{ transform:translateY(0px); filter:brightness(.98); }
  #va-planner .va-topBtn.secondary{
    background:rgba(12,14,25,.65);
    border:1px solid rgba(255,255,255,.12);
    color:var(--ink);
    box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
  }
  /* ============================================================
    //#4 TOP “HEALTH PACK” (kept, tightened to match FAD)
    ✅ Removed Fiduciary Guidance card
  ============================================================ */
  #va-planner .va-topPack{
    min-width:0;
    border-radius:var(--radius);
    border:1px solid var(--stroke);
    background:
      radial-gradient(120% 140% at 15% 0%, rgba(142,243,197,.10), transparent 55%),
      radial-gradient(120% 140% at 100% 15%, rgba(106,167,255,.10), transparent 55%),
      linear-gradient(180deg, rgba(16,20,38,.90), rgba(11,14,26,.55));
    box-shadow:var(--shadow);
    padding:14px;
    position:relative;
    overflow:hidden;
  }
  #va-planner .va-packRow{
    display:grid;
    grid-template-columns:1fr;
    gap:10px;
    min-width:0;
  }
  #va-planner .va-status{
    display:flex; align-items:flex-start; gap:10px;
    padding:12px;
    border-radius:14px;
    background:rgba(12,14,25,.55);
    border:1px solid rgba(255,255,255,.08);
    box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
  }
  #va-planner .va-status.ok{ outline:2px solid rgba(85,211,153,.16); }
  #va-planner .va-status.warn{ outline:2px solid rgba(249,199,79,.16); }
  #va-planner .va-status.bad{ outline:2px solid rgba(255,107,107,.16); }
  #va-planner .va-dot{ width:10px; height:10px; border-radius:50%; }
  #va-planner .va-meter{
    height:14px;
    border-radius:999px;
    overflow:hidden;
    background:rgba(11,14,26,.55);
    border:1px solid rgba(255,255,255,.08);
    box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
  }
  #va-planner .va-note{ color:var(--muted); font-size:12px; line-height:1.4; }
  #va-planner .va-meterNote{ margin-top:2px; display:block; }
  /* ============================================================
    //#5 KPIs (FAD-style cards)
  ============================================================ */
  #va-planner .va-kpi{
    display:grid;
    grid-template-columns:repeat(5,minmax(0,1fr));
    gap:12px;
    margin-top:14px;
  }
  @media (max-width:1100px){ #va-planner .va-kpi{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
  @media (max-width:520px){ #va-planner .va-kpi{ grid-template-columns:1fr; } }
  #va-planner .va-kpi .box{
    min-width:0;
    background:
      radial-gradient(120% 140% at 0% 0%, rgba(106,167,255,.10), transparent 60%),
      linear-gradient(180deg, rgba(16,20,38,.86), rgba(11,14,26,.40));
    border:1px solid var(--stroke);
    border-radius:16px;
    padding:12px 12px 11px;
    box-shadow:0 14px 32px rgba(0,0,0,.45);
  }
  #va-planner .va-kpi .box small{
    display:block;
    color:var(--muted);
    font-size:11px;
    letter-spacing:.10em;
    text-transform:uppercase;
  }
  #va-planner .va-kpi .box b{
    display:block;
    margin-top:7px;
    font-size:18px;
    font-weight:900;
    letter-spacing:.2px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  #va-planner b.good{color:var(--ok)}
  #va-planner b.warn{color:var(--warn)}
  #va-planner b.bad{color:var(--bad)}
  #va-planner b.neutral{color:var(--ink)}
  /* ============================================================
    //#6 MAIN GRID + CARDS
  ============================================================ */
  #va-planner .va-grid{
    display:grid;
    grid-template-columns:minmax(0,1.12fr) minmax(0,.88fr);
    gap:16px;
    margin-top:16px;
    align-items:start;
    min-width:0;
  }
  @media (max-width:980px){ #va-planner .va-grid{ grid-template-columns:1fr; } }
  #va-planner .va-card{
    min-width:0;
    background:
      radial-gradient(120% 140% at 15% 0%, rgba(142,243,197,.08), transparent 60%),
      linear-gradient(180deg, rgba(16,20,38,.86), rgba(11,14,26,.40));
    border:1px solid var(--stroke);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:16px;
    position:relative;
    overflow:hidden;
  }
  #va-planner .va-card h2{ margin:0 0 10px; font-size:16px; letter-spacing:.3px; }
  #va-planner .va-mt8{margin-top:8px} .va-mt12{margin-top:12px} .va-mt16{margin-top:16px} .va-mt20{margin-top:20px}
  #va-planner .va-row{
    display:grid;
    grid-template-columns:minmax(0,1fr) minmax(0,1fr);
    gap:12px;
    min-width:0;
  }
  @media (max-width:700px){ #va-planner .va-row{ grid-template-columns:1fr; } }
  #va-planner .va-field{ display:flex; flex-direction:column; gap:8px; min-width:0; }
  #va-planner .va-field label{ font-size:12px; color:var(--muted); letter-spacing:.08em; text-transform:uppercase; }
  /* ============================================================
    //#7 INPUT STRIP TOKENS (House of SaSS canonical)
  ============================================================ */
  #va-planner .va-input,
  #va-planner .va-select,
  #va-planner .va-slider,
  #va-planner .va-btn{
    width:100%;
    min-width:0;
    border:1px solid rgba(255,255,255,.10);
    background:rgba(12,14,25,.65);
    color:var(--ink);
    border-radius:10px;
    padding:12px;
    font-size:14px;
    outline:none;
    box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
  }
  #va-planner .va-input:focus,
  #va-planner .va-select:focus{
    border-color:rgba(142,243,197,.45);
    box-shadow:0 0 0 1px rgba(142,243,197,.18), 0 0 24px rgba(142,243,197,.10);
  }
  #va-planner .va-select{ appearance:none; }
  #va-planner .va-btn{
    cursor:pointer;
    border:none;
    border-radius:999px;
    background:radial-gradient(120% 120% at 25% 15%, var(--accent2), var(--accent));
    color:#050712;
    font-weight:900;
    letter-spacing:.02em;
    box-shadow:0 14px 30px rgba(0,0,0,.60);
    transition:transform .12s ease, filter .12s ease;
  }
  #va-planner .va-btn:hover{ transform:translateY(-1px); filter:brightness(1.03); }
  #va-planner .va-btn:active{ transform:translateY(0px); filter:brightness(.98); }
  #va-planner .va-btn.secondary{
    background:radial-gradient(120% 120% at 25% 15%, rgba(142,243,197,.92), rgba(125,233,189,.62));
    color:#04120d;
  }
  #va-planner .va-btn.ghost{
    background:rgba(12,14,25,.65);
    border:1px dashed rgba(255,255,255,.18);
    color:var(--ink);
    font-weight:800;
    box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
  }
  #va-planner .toggle{ display:flex; align-items:center; gap:10px; margin-top:8px; }
  #va-planner .hidden{ display:none !important; }
  /* ============================================================
    //#8 BUDGET PANEL
  ============================================================ */
  #va-planner .bp-panel{
    margin-top:10px;
    border:1px dashed rgba(255,255,255,.14);
    border-radius:14px;
    padding:12px;
    background:rgba(15,19,38,.75);
  }
  #va-planner .bp-row{
    display:grid;
    grid-template-columns:130px minmax(0,1fr) 160px 90px;
    gap:8px;
    align-items:center;
    min-width:0;
  }
  @media(max-width:720px){ #va-planner .bp-row{ grid-template-columns:1fr; } }
  #va-planner .bp-table{ width:100%; border-collapse:separate; border-spacing:0 8px; margin-top:10px; }
  #va-planner .bp-tr{ background:rgba(12,14,25,.65); border:1px solid rgba(255,255,255,.10); border-radius:12px; }
  #va-planner .bp-td,#va-planner .bp-th{ padding:8px 10px; font-size:13px; }
  #va-planner .bp-controls{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
  #va-planner .bp-chip{
    padding:6px 10px;
    border-radius:999px;
    background:rgba(12,14,25,.65);
    border:1px solid rgba(255,255,255,.12);
    font-size:12px;
    color:var(--muted);
  }
  #va-planner .va-footer{ margin-top:18px; color:var(--muted); font-size:12px; text-align:center; }
</style>
      <div id="va-fullscreen-shell">
        <div id="va-planner">
          <div class="va-wrap">
            <!--  ============================================================
        //#A TOP BAR (FAD vibe; buttons reuse existing logic)
      ============================================================  -->
            <div class="va-topbar">
              <div class="va-topLeft">
                <span class="va-pill">
                  <span class="va-miniDot" id="vaTopDot"></span>
                  <small>Status</small>
                  <b id="vaTopStatus">Healthy</b>
                </span>
                <span class="va-pill" style="min-width:0; max-width:52vw;">
                  <small style="flex:0 0 auto;">BLUF</small>
                  <b id="vaTopBluf" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">Enter values to see your cash-flow verdict.</b>
                </span>
              </div>
              <div class="va-topRight">
                <button class="va-topBtn secondary" id="btn-clear-top" type="button">Reset</button>
                <button class="va-topBtn" id="btn-calc-top" type="button">Update</button>
              </div>
            </div>
            <!--  ============================================================
        TOP PACK (✅ Fiduciary Guidance removed)
      ============================================================  -->
            <div class="va-topPack">
              <div class="va-packRow">
                <div class="va-status ok" id="statusBox">
                  <div id="statusDot" class="va-dot" style="width:12px;height:12px;background:var(--ok)"></div>
                  <div>
                    <div id="statusTitle" style="font-weight:900">Healthy Plan</div>
                    <div id="statusMsg" class="va-note">You remain cash-flow positive after expenses, savings, and the proposed housing payment.</div>
                  </div>
                </div>
                <div class="va-meter">
                  <div id="meterFill" style="height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--warn),var(--bad));"></div>
                </div>
                <small class="va-note va-meterNote" id="meterNote">
                  Meter shows share of income consumed by <b>Expenses + Savings + Housing</b>. Under 70% comfortable, 70–85% caution, above 85% risky.
                </small>
              </div>
            </div>
            <div class="va-kpi" id="kpis">
              <div class="box"><small>Total Monthly Income</small><b id="kpi-income">$0</b></div>
              <div class="box"><small>Total Monthly Expenses</small><b id="kpi-expenses">$0</b></div>
              <div class="box"><small>Housing Estimate</small><b id="kpi-mortgage">$0</b></div>
              <div class="box"><small>Target Savings</small><b id="kpi-savings">$0</b></div>
              <div class="box"><small>Disposable After Housing</small><b id="kpi-disposable" class="neutral">$0</b></div>
            </div>
            <div class="va-grid">
              <!--  LEFT  -->
              <div class="va-card">
                <h2>1) Income</h2>
                <div class="va-row va-mt8">
                  <div class="va-field">
                    <label>Total Monthly Income ($)</label>
                    <input class="va-input" id="in-total" type="number" min="0" step="1" placeholder="e.g., 9000">
                    <small class="va-note">Use gross or net—just be consistent with your expenses.</small>
                  </div>
                  <div class="va-field">
                    <label>Additional Income ($)</label>
                    <input class="va-input" id="in-addl" type="number" min="0" step="1" placeholder="Commission, spouse, side income">
                  </div>
                </div>
                <!--  Optional legacy panel (hidden by default for RealtySaSS)  -->
                <div class="toggle hidden">
                  <button class="va-btn ghost" id="btn-mil">▼ Military Pay (optional)</button>
                  <small class="va-note" id="mil-msg">Hidden for non-military Realtor SaaS.</small>
                </div>
                <div id="mil-panel" class="hidden va-mt8"></div>
                <h2 class="va-mt16">2) Expenses</h2>
                <div class="va-row va-mt8">
                  <div class="va-field"><label>Core Monthly Expenses ($)</label><input class="va-input" id="ex-core" type="number" min="0" step="1" placeholder="Bills, debt, utilities"></div>
                  <div class="va-field"><label>Discretionary Spending ($)</label><input class="va-input" id="ex-disc" type="number" min="0" step="1" placeholder="Dining, travel, subscriptions"></div>
                </div>
                <div class="toggle va-mt8">
                  <button class="va-btn ghost" id="btn-bp">▼ Itemized Monthly Budget (optional)</button>
                  <small class="va-note">Makes the bar chart smarter (and improves conversations with leads).</small>
                </div>
                <div id="bp-panel" class="hidden bp-panel">
                  <div class="bp-row">
                    <select id="bp-cat" class="va-select">
                      <option>Essentials</option>
                      <option>Discretionary</option>
                      <option>Debt</option>
                      <option>Other</option>
                    </select>
                    <input id="bp-name" class="va-input" placeholder="Item name (e.g., Rent, Groceries)">
                    <input id="bp-month" class="va-input" type="number" min="0" step="1" placeholder="Monthly $">
                    <button id="bp-add" class="va-btn">Add</button>
                  </div>
                  <table class="bp-table">
                    <thead>
                      <tr class="bp-tr">
                        <th class="bp-th">Category</th>
                        <th class="bp-th">Item</th>
                        <th class="bp-th">Monthly</th>
                        <th class="bp-th">Annual</th>
                        <th class="bp-th">Del</th>
                      </tr>
                    </thead>
                    <tbody id="bp-body"></tbody>
                  </table>
                  <div class="bp-controls">
                    <span class="bp-chip">Essentials: <b id="bp-t-Essentials">$0</b></span>
                    <span class="bp-chip">Discretionary: <b id="bp-t-Discretionary">$0</b></span>
                    <span class="bp-chip">Debt: <b id="bp-t-Debt">$0</b></span>
                    <span class="bp-chip">Other: <b id="bp-t-Other">$0</b></span>
                    <span class="bp-chip">Total: <b id="bp-t-All">$0</b></span>
                    <button id="bp-load" class="va-btn" style="margin-left:auto">Load Example</button>
                    <button id="bp-save" class="va-btn secondary">Save & Prefill</button>
                  </div>
                  <div class="va-note" id="bp-note" style="margin-top:6px">Not saved yet.</div>
                </div>
                <h2 class="va-mt16">3) Savings Target</h2>
                <div class="va-field va-mt8">
                  <label>Desired Savings Rate <span id="save-rate-label" style="color:var(--accent2);font-weight:800">15%</span></label>
                  <input class="va-slider" id="save-rate" type="range" min="0" max="40" step="1" value="15">
                  <small class="va-note">Savings comes before house—protect your buffer.</small>
                </div>
                <div class="va-row va-mt16" style="grid-template-columns:1fr 1fr">
                  <button class="va-btn secondary" id="btn-clear" type="button">Reset</button>
                  <button class="va-btn" id="btn-calc" type="button">Update</button>
                </div>
              </div>
              <!--  RIGHT (✅ Visual Budget removed; replaced with Section 4) Home Scenario)  -->
              <div class="va-card">
                <h2>4) Home Scenario (What-If)</h2>
                <div class="va-field va-mt8">
                  <label>Credit Score <span id="cs-label">720 – Good</span></label>
                  <input class="va-slider" id="cs-slider" type="range" min="500" max="850" step="5" value="720">
                </div>
                <div class="va-note">Estimated APR from credit score: <b id="apr-label">7.00%</b> (illustrative).</div>
                <div class="va-row va-mt12">
                  <div class="va-field">
                    <label>Home Price ($)</label>
                    <input class="va-input" id="h-price" type="number" min="0" step="1000" placeholder="e.g., 450000">
                  </div>
                  <div class="va-field">
                    <label>Down Payment % <span id="dp-pct-label">20%</span> = <span id="dp-amt-label">$0</span></label>
                    <input class="va-slider" id="dp-slider" type="range" min="0" max="100" step="1" value="20">
                  </div>
                </div>
                <div class="va-row va-mt8">
                  <div class="va-field"><label>Interest Rate (APR %)</label><input class="va-input" id="h-rate" type="number" step="0.01" value="7.00"></div>
                  <div class="va-field"><label>Down Payment ($)</label><input class="va-input" id="dp-amt" type="text" disabled=""></div>
                </div>
                <div class="va-row va-mt8">
                  <div class="va-field"><label>Term (years)</label><input class="va-input" id="h-term" type="number" min="5" max="40" step="1" value="30"></div>
                  <div class="va-field"><label>Taxes + Insurance + HOA ($/mo)</label><input class="va-input" id="h-tihoa" type="number" min="0" step="1" value="0"></div>
                </div>
                <div class="va-row va-mt8">
                  <div class="va-field"><label>PMI ($/mo)</label><input class="va-input" id="h-pmi" type="number" min="0" step="1" value="0"></div>
                  <div class="va-field"><label>&nbsp;</label>
                    <div class="va-note">APR/PMI are illustrative only; verify with your lender.</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="va-footer">For education only, not financial advice.</div>
          </div>
        </div>
      </div>
      <script>
(()=>{
  // ============================================================
  // //#JS1 MOUNT GUARD (logic unchanged)
  // ============================================================
  if (window.__RSAP_PLANNER_MOUNTED__) return;
  window.__RSAP_PLANNER_MOUNTED__ = true;
  const $=(q)=>document.querySelector(q);
  const $$=(q)=>Array.from(document.querySelectorAll(q));
  const fmt=(n)=> (Number(n)||0).toLocaleString('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0});
  const clamp01=(x)=>Math.max(0,Math.min(1,x));
  function pmti(P,r,n){ if(r===0) return P/n; const x=Math.pow(1+r,n); return P*(r*x)/(x-1); }
  const el={
    total:$('#in-total'), addl:$('#in-addl'),
    exCore:$('#ex-core'), exDisc:$('#ex-disc'),
    bpBtn:$('#btn-bp'), bpPanel:$('#bp-panel'),
    saveRate:$('#save-rate'),
    cs:$('#cs-slider'), csLabel:$('#cs-label'), aprLabel:$('#apr-label'),
    hPrice:$('#h-price'), dpSlider:$('#dp-slider'), dpPctLabel:$('#dp-pct-label'),
    dpAmtLabel:$('#dp-amt-label'), dpAmt:$('#dp-amt'),
    hRate:$('#h-rate'), hTerm:$('#h-term'), hTIHOA:$('#h-tihoa'), hPMI:$('#h-pmi'),
    btnCalc:$('#btn-calc'), btnClear:$('#btn-clear'),
    btnCalcTop:$('#btn-calc-top'), btnClearTop:$('#btn-clear-top'),
    kIncome:$('#kpi-income'), kExp:$('#kpi-expenses'), kMortgage:$('#kpi-mortgage'),
    kSave:$('#kpi-savings'), kDisp:$('#kpi-disposable'),
    statusBox:$('#statusBox'), statusDot:$('#statusDot'), statusTitle:$('#statusTitle'),
    statusMsg:$('#statusMsg'), meterFill:$('#meterFill'),
    bpLoad:$('#bp-load'),
    topDot:$('#vaTopDot'), topStatus:$('#vaTopStatus'), topBluf:$('#vaTopBluf')
  };
  function scoreAPRLocal(score){
    const s=Number(score)||720;
    if(s>=780) return 6.50; if(s>=760) return 6.75; if(s>=720) return 7.00;
    if(s>=700) return 7.20; if(s>=680) return 7.35; if(s>=660) return 7.85;
    if(s>=640) return 8.25; if(s>=620) return 9.25; return 9.95;
  }
  /* ---------- itemized budget store ---------- */
  let BP_ROWS=[], BP_ID=1;
  function bpTotals(){ const t={Essentials:0,Discretionary:0,Debt:0,Other:0};
    BP_ROWS.forEach(r=> t[r.cat]+=Number(r.month)||0);
    t.All=t.Essentials+t.Discretionary+t.Debt+t.Other; return t;
  }
  function bpTotalsUI(){
    const t=bpTotals();
    $('#bp-t-Essentials').textContent=fmt(t.Essentials);
    $('#bp-t-Discretionary').textContent=fmt(t.Discretionary);
    $('#bp-t-Debt').textContent=fmt(t.Debt);
    $('#bp-t-Other').textContent=fmt(t.Other);
    $('#bp-t-All').textContent=fmt(t.All);
  }
  function bpRender(){
    const tb=$('#bp-body'); if(!tb) return; tb.innerHTML='';
    BP_ROWS.forEach(r=>{
      const tr=document.createElement('tr'); tr.className='bp-tr';
      tr.innerHTML=`<td class="bp-td"><select class="va-select bp-cat" data-id="${r.id}">
          <option ${r.cat==='Essentials'?'selected':''}>Essentials</option>
          <option ${r.cat==='Discretionary'?'selected':''}>Discretionary</option>
          <option ${r.cat==='Debt'?'selected':''}>Debt</option>
          <option ${r.cat==='Other'?'selected':''}>Other</option>
        </select></td>
        <td class="bp-td"><input class="va-input bp-name" data-id="${r.id}" value="${r.name||''}"></td>
        <td class="bp-td" style="width:160px"><input class="va-input bp-month" data-id="${r.id}" type="number" min="0" step="1" value="${r.month||0}"></td>
        <td class="bp-td" style="width:120px">${fmt((r.month||0)*12)}</td>
        <td class="bp-td" style="width:80px"><button class="va-btn ghost bp-del" data-id="${r.id}">✕</button></td>`;
      tb.appendChild(tr);
    });
    $$('.bp-cat').forEach(x=>x.addEventListener('change',e=>{ const rr=BP_ROWS.find(z=>z.id==e.target.dataset.id); if(rr){rr.cat=e.target.value; bpTotalsUI();}}));
    $$('.bp-name').forEach(x=>x.addEventListener('input',e=>{ const rr=BP_ROWS.find(z=>z.id==e.target.dataset.id); if(rr) rr.name=e.target.value; }));
    $$('.bp-month').forEach(x=>x.addEventListener('input',e=>{ const rr=BP_ROWS.find(z=>z.id==e.target.dataset.id); if(rr){rr.month=Number(e.target.value)||0; bpTotalsUI();}}));
    $$('.bp-del').forEach(x=>x.addEventListener('click',e=>{ BP_ROWS=BP_ROWS.filter(r=>r.id!==Number(e.target.dataset.id)); bpRender(); }));
    bpTotalsUI();
  }
  $('#bp-add')?.addEventListener('click', ()=>{
    const cat=$('#bp-cat').value;
    const name=$('#bp-name').value.trim()||'Item';
    const m=Number($('#bp-month').value)||0;
    BP_ROWS.push({id:BP_ID++,cat,name,month:m});
    $('#bp-name').value=''; $('#bp-month').value='';
    bpRender();
  });
  $('#bp-save')?.addEventListener('click', ()=>{
    const t=bpTotals();
    const core=t.Essentials+t.Debt+t.Other;
    const disc=t.Discretionary;
    localStorage.setItem('va.expenses.core', String(Math.round(core)));
    localStorage.setItem('va.expenses.disc', String(Math.round(disc)));
    localStorage.setItem('va.expenses.rows', JSON.stringify(BP_ROWS));
    localStorage.setItem('realtysass.afford.expenses.core', String(Math.round(core)));
    localStorage.setItem('realtysass.afford.expenses.disc', String(Math.round(disc)));
    localStorage.setItem('realtysass.afford.expenses.rows', JSON.stringify(BP_ROWS));
    $('#bp-note').textContent='Saved! Totals copied above.';
    el.exCore.value=Math.round(core);
    el.exDisc.value=Math.round(disc);
    render();
  });
  $('#bp-load')?.addEventListener('click', ()=>{
    BP_ROWS=[
      {id:1,cat:'Essentials',name:'Rent',month:1800},
      {id:2,cat:'Essentials',name:'Utilities',month:260},
      {id:3,cat:'Essentials',name:'Insurance',month:220},
      {id:4,cat:'Essentials',name:'Car Payment',month:420},
      {id:5,cat:'Discretionary',name:'Food & Dining',month:650},
      {id:6,cat:'Discretionary',name:'Subscriptions',month:110},
      {id:7,cat:'Debt',name:'Credit Cards',month:250}
    ];
    BP_ID=8; bpRender();
    const t=bpTotals(); el.exCore.value=Math.round(t.Essentials+t.Debt+t.Other); el.exDisc.value=Math.round(t.Discretionary);
    render();
    $('#bp-note').textContent='Example loaded. Edit amounts, then Save & Prefill to store.';
  });
  (function bpRestore(){
    try{
      const raw = localStorage.getItem('realtysass.afford.expenses.rows') || localStorage.getItem('va.expenses.rows');
      if(raw){
        BP_ROWS=JSON.parse(raw)||[];
        BP_ID=BP_ROWS.reduce((m,r)=>Math.max(m,r.id||0),0)+1;
        bpRender();
      }
      const core=+(
        localStorage.getItem('realtysass.afford.expenses.core') ||
        localStorage.getItem('va.expenses.core')
      )||0;
      const disc=+(
        localStorage.getItem('realtysass.afford.expenses.disc') ||
        localStorage.getItem('va.expenses.disc')
      )||0;
      if(core||disc){ el.exCore.value=core; el.exDisc.value=disc; }
    }catch(e){}
  })();
  function readNum(i){ return Number.parseFloat((i&&i.value)||'0')||0; }
  function compute(){
    const income = readNum(el.total) + readNum(el.addl);
    const expenses = readNum(el.exCore) + readNum(el.exDisc);
    const saveRate=(Number(el.saveRate.value)||0)/100;
    const savings = Math.max(0, income * saveRate);
    const inferredAPR = scoreAPRLocal(el.cs.value);
    const usedAPR = Number(el.hRate.value)||inferredAPR;
    const price = readNum(el.hPrice);
    const dpPct = (Number(el.dpSlider.value)||0)/100;
    const downAmount = Math.max(0, price * dpPct);
    const loan = Math.max(0, price - downAmount);
    const mRate = (usedAPR||0)/100/12;
    const nMonths = Math.max(1, (Number(el.hTerm.value)||30)*12);
    const pAndI = loan>0 ? pmti(loan, mRate, nMonths) : 0;
    const tihoa = readNum(el.hTIHOA);
    const pmi = readNum(el.hPMI);
    const housing = pAndI + tihoa + pmi;
    const freePost = income - expenses - savings - housing;
    const housingShare = income>0 ? housing/income : 0;
    const totalShare   = income>0 ? (expenses + savings + housing)/income : 0;
    const dti          = income>0 ? (expenses + housing)/income : 0;
    return {income,expenses,savings,housing,freePost,housingShare,totalShare,dti,loan,pAndI,dpPct,downAmount,inferredAPR,usedAPR};
  }
  function render(){
    const s=compute();
    el.kIncome.textContent=fmt(s.income);
    el.kExp.textContent=fmt(s.expenses);
    el.kSave.textContent=fmt(s.savings);
    el.kMortgage.textContent=fmt(s.housing);
    el.kDisp.textContent = s.freePost>=0 ? fmt(s.freePost) : ('-'+fmt(Math.abs(s.freePost)));
    const shareAfter = s.income>0 ? (s.freePost/s.income) : 0;
    let cls='neutral';
    if (s.freePost<0) cls='bad';
    else if (shareAfter>=.2) cls='good';
    else if (shareAfter>=.1) cls='warn';
    el.kDisp.className='';
    el.kDisp.classList.add(cls);
    el.meterFill.style.width=(clamp01(s.totalShare)*100).toFixed(0)+'%';
    let title='Healthy Plan', msg='You remain cash-flow positive after expenses, savings, and housing.', cls2='ok', dot='var(--ok)';
    if (s.totalShare>=0.85 || s.freePost<0){
      title='Risky: Overcommitted';
      msg='This scenario likely overextends cash flow. Reduce price/rate/expenses.';
      cls2='bad'; dot='var(--bad)';
    } else if (s.totalShare>=0.70){
      title='Caution Zone';
      msg='Budget is tight. Aim for ≥15% buffer after all costs.';
      cls2='warn'; dot='var(--warn)';
    }
    el.statusBox.classList.remove('ok','warn','bad'); el.statusBox.classList.add(cls2);
    el.statusTitle.textContent=title;
    el.statusMsg.textContent=msg;
    el.statusDot.style.background=`${dot}`;
    // FAD topbar mirroring (visual only)
    if(el.topDot) el.topDot.style.background = dot;
    if(el.topStatus) el.topStatus.textContent = (cls2==='ok'?'Healthy':(cls2==='warn'?'Caution':'Risky'));
    if(el.topBluf){
      const disp = s.freePost>=0 ? fmt(s.freePost) : ('-'+fmt(Math.abs(s.freePost)));
      el.topBluf.textContent =
        (cls2==='ok')
          ? `You’re positive after housing. Disposable: ${disp}.`
          : (cls2==='warn')
            ? `Tight buffer after housing. Disposable: ${disp}.`
            : `Overcommitted at this scenario. Disposable: ${disp}.`;
    }
    const score=Number(el.cs.value)||720;
    const band=score>=760?'Excellent':score>=720?'Good':score>=680?'Fair':score>=640?'OK':score>=620?'Weak':'Subprime';
    el.csLabel.textContent=`${score} – ${band}`;
    el.aprLabel.textContent=(s.inferredAPR||0).toFixed(2)+'%';
    el.dpPctLabel.textContent=(s.dpPct*100).toFixed(0)+'%';
    el.dpAmtLabel.textContent=fmt(s.downAmount);
    el.dpAmt.value=fmt(s.downAmount);
  }
  function wire(){
    el.bpBtn.addEventListener('click', ()=>{
      el.bpPanel.classList.toggle('hidden');
      el.bpBtn.textContent = el.bpPanel.classList.contains('hidden') ? '▼ Itemized Monthly Budget (optional)' : '▲ Itemized Monthly Budget (hide)';
    });
    [el.total,el.addl,el.exCore,el.exDisc,el.hPrice,el.hRate,el.hTerm,el.hTIHOA,el.hPMI].forEach(i=> i && i.addEventListener('input', render));
    el.saveRate.addEventListener('input', ()=>{ $('#save-rate-label').textContent=el.saveRate.value+'%'; render(); });
    el.cs.addEventListener('input', ()=>{
      if(!el.hRate.dataset.touched){ el.hRate.value = scoreAPRLocal(el.cs.value).toFixed(2); }
      render();
    });
    el.hRate.addEventListener('input', ()=>{ el.hRate.dataset.touched='1'; render(); });
    const updDP=()=>{ const s=compute();
      el.dpPctLabel.textContent=(s.dpPct*100).toFixed(0)+'%';
      el.dpAmtLabel.textContent=fmt(s.downAmount);
      el.dpAmt.value=fmt(s.downAmount);
    };
    el.dpSlider.addEventListener('input', ()=>{ updDP(); render(); });
    el.hPrice.addEventListener('input', ()=>{ updDP(); render(); });
    el.btnCalc.addEventListener('click', render);
    el.btnClear.addEventListener('click', ()=>{
      $$('input').forEach(inp=>{ if(inp.type==='range') return; if(!inp.disabled) inp.value=''; });
      el.saveRate.value=15; $('#save-rate-label').textContent='15%';
      el.cs.value=720; el.hRate.value=scoreAPRLocal(720).toFixed(2); el.hRate.dataset.touched='';
      el.dpSlider.value=20;
      render();
    });
    // Topbar buttons mirror existing ones
    el.btnCalcTop?.addEventListener('click', ()=> el.btnCalc.click());
    el.btnClearTop?.addEventListener('click', ()=> el.btnClear.click());
    render();
  }
  if (document.readyState==='loading') document.addEventListener('DOMContentLoaded', wire, {once:true});
  else wire();
})();
</script>
    </div>
  </section>
  <section class="commercial">
    <div class="w-layout-blockcontainer container-full reviews-image no-max-width w-container">
      <div class="space-large-2"></div>
      <div data-delay="5000" data-animation="slide" class="slider-testimonial slide-up-animation w-slider" data-autoplay="false" data-easing="ease-in-out" data-hide-arrows="false" data-disable-swipe="false" data-autoplay-limit="0" data-nav-spacing="3" data-duration="500" data-infinite="true">
        <div class="mask-testimonial w-slider-mask">
          <div class="slide w-slide">
            <div class="testimonial-text-wrapper-2">
              <h6 class="heading-19">A.I Driven Financial Analysis</h6>
              <h2 class="heading-18">Provide your Customer with Financial Insight</h2>
              <p class="max-width-36rem-2">Imagine have not just a motivated Client, but one that is fully aware of his/her financial health, and Clear Understanding of their Buying Power! Now, Image him discovering his potential on Your Own Website. </p>
            </div>
            <div class="testimonial-image-wrapper">
              <div class="testimonial-client-wrapper-3"><img sizes="800px" srcset="images/b4ab8f37201140495c2b4eb2080e3216_RS-p-500.png 500w, images/RS.png 800w" alt="Logo" src="images/RS.png" loading="eager" class="image-small-circle-02">
                <div class="testimonial-info-wrapper">
                  <div class="stars-wrapper"><img loading="eager" src="https://cdn.prod.website-files.com/697fe2c721f90c643e779123/697fe2ca21f90c643e779167_star.png" alt="" class="star-2"><img loading="eager" src="https://cdn.prod.website-files.com/697fe2c721f90c643e779123/697fe2ca21f90c643e779167_star.png" alt="" class="star-2"><img loading="eager" src="https://cdn.prod.website-files.com/697fe2c721f90c643e779123/697fe2ca21f90c643e779167_star.png" alt="" class="star-2"><img loading="eager" src="https://cdn.prod.website-files.com/697fe2c721f90c643e779123/697fe2ca21f90c643e779167_star.png" alt="" class="star-2"><img loading="eager" src="https://cdn.prod.website-files.com/697fe2c721f90c643e779123/697fe2ca21f90c643e779167_star.png" alt="" class="star-2"></div>
                  <h6 class="color-white centered-on-mobile">Financial Analysis Calculator with A.I Fidicuary Analysis.<br><br>Software for the Modern Realtor</h6>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="left-arrow w-slider-arrow-left">
          <div class="w-icon-slider-left"></div>
        </div>
        <div class="right-arrow w-slider-arrow-right">
          <div class="w-icon-slider-right"></div>
        </div>
        <div class="slide-nav-testimonial-2 w-slider-nav w-round"></div>
      </div>
      <div class="space-large-2"></div>
    </div>
  </section>
  <section class="section-262">
    <div class="w-embed w-script"><!--  ============================================================
  House of SaSS • Fiduciary Snapshot (Embed #2) — FULL BLEED FIX
  ✅ FIX: Snapshot breaks out of narrow Webflow column/container
  ✅ Full-bleed 100vw shell + centered max inner width
  ✅ NO changes to calculations/logic (visual/layout only)
===============================================================  -->
      <div id="fid-snapshot" style="all: initial;">
        <style>
    /* ============================================================
      #0 FULL-BLEED BREAKOUT (THIS IS THE FIX)
      - Forces this embed to render at 100vw even inside a narrow column
    ============================================================ */
    #fid-snapshot{
      display:block;
      width:100%;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink);
    }
    #fid-snapshot .fid-breakout{
      width:100vw;
      position:relative;
      left:50%;
      right:50%;
      margin-left:-50vw;
      margin-right:-50vw;
      /* Important: keep overflow visible so shadows/glow aren't clipped */
      overflow:visible;
    }
    #fid-snapshot .wrap{
      /* Inner content width (like FAD) */
      max-width:1344px;
      margin:18px auto 56px;
      padding:0 16px;
      color:var(--ink);
    }
    /* ============================================================
      #1 RESET + TOKENS
    ============================================================ */
    #fid-snapshot, #fid-snapshot *{
      box-sizing:border-box;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    #fid-snapshot{
      --bg:#0b0e1a;
      --panel:#101426;
      --panel2:#0f1324;
      --card:rgba(16,20,38,.82);
      --card2:rgba(15,19,36,.72);
      --ink:#e9ecff;
      --muted:#a8b0d6;
      --accent:#8ef3c5;
      --accent2:#6aa7ff;
      --ok:#55d399;
      --warn:#f9c74f;
      --bad:#ff6b6b;
      --stroke:rgba(255,255,255,.08);
      --shadow:0 24px 48px rgba(0,0,0,.80);
      --radius:18px;
      color:var(--ink);
    }
    /* ============================================================
      #2 MAIN CARD (glassy)
    ============================================================ */
    #fid-snapshot .card{
      width:100%;
      background:
        radial-gradient(120% 140% at 15% 0%, rgba(142,243,197,.12), transparent 50%),
        radial-gradient(120% 140% at 100% 15%, rgba(106,167,255,.12), transparent 55%),
        linear-gradient(180deg, rgba(16,20,38,.90), rgba(11,14,26,.55));
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      position:relative;
      overflow:hidden;
    }
    #fid-snapshot .card:before{
      content:"";
      position:absolute; inset:-2px;
      background:
        linear-gradient(transparent 0 0),
        repeating-linear-gradient(90deg, rgba(255,255,255,.04) 0 1px, transparent 1px 42px),
        repeating-linear-gradient(0deg, rgba(255,255,255,.03) 0 1px, transparent 1px 42px);
      opacity:.18;
      pointer-events:none;
      mask-image: radial-gradient(120% 90% at 50% 0%, #000 60%, transparent 100%);
    }
    #fid-snapshot .card > *{ position:relative; z-index:1; }
    /* ============================================================
      #3 TOP STRIP (Status + BLUF + actions)
    ============================================================ */
    #fid-snapshot .topbar{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(12,14,25,.55);
      box-shadow:0 14px 30px rgba(0,0,0,.35);
      margin-bottom:12px;
      flex-wrap:wrap;
    }
    #fid-snapshot .top-left{
      display:flex; align-items:center; gap:10px; min-width:0; flex:1;
    }
    #fid-snapshot .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      background:rgba(12,14,25,.65);
      border:1px solid rgba(255,255,255,.12);
      color:#cfd5ff;
      font-size:12px;
      white-space:nowrap;
    }
    #fid-snapshot .dot{ width:10px; height:10px; border-radius:50%; background:#888; }
    #fid-snapshot .bluf{
      color:#cfd5ff;
      font-size:13px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:820px;
    }
    #fid-snapshot .actions{ display:flex; gap:10px; align-items:center; }
    #fid-snapshot .btn{
      cursor:pointer;
      border:none;
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      letter-spacing:.02em;
      background:radial-gradient(120% 120% at 25% 15%, var(--accent), var(--accent2));
      color:#050712;
    }
    #fid-snapshot .btn.ghost{
      background:rgba(12,14,25,.55);
      border:1px solid rgba(255,255,255,.14);
      color:var(--ink);
    }
    /* ============================================================
      #4 KEY ROW (compact)
    ============================================================ */
    #fid-snapshot .keyrow{
      display:grid;
      grid-template-columns:1fr auto;
      gap:12px;
      align-items:center;
      margin-bottom:12px;
      min-width:0;
    }
    @media(max-width:860px){ #fid-snapshot .keyrow{ grid-template-columns:1fr; } }
    #fid-snapshot .kbox{
      background:rgba(12,14,25,.65);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:12px;
      box-shadow:inset 0 1px 0 rgba(255,255,255,.05);
      min-width:0;
    }
    #fid-snapshot .kbox label{
      display:block;
      color:var(--muted);
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
      margin-bottom:6px;
    }
    #fid-snapshot .input{
      width:100%;
      min-width:0;
      background:rgba(12,14,25,.70);
      border:1px solid rgba(255,255,255,.12);
      color:var(--ink);
      border-radius:12px;
      padding:12px 12px;
      font-size:14px;
      outline:none;
      transition:box-shadow .15s,border-color .15s;
    }
    #fid-snapshot .input:focus{
      border-color:rgba(142,243,197,.45);
      box-shadow:0 0 0 1px rgba(142,243,197,.18), 0 0 28px rgba(142,243,197,.10);
    }
    #fid-snapshot .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(12,14,25,.55);
      box-shadow:0 10px 22px rgba(0,0,0,.35);
      white-space:nowrap;
      justify-self:end;
    }
    @media(max-width:860px){ #fid-snapshot .badge{ justify-self:start; } }
    #fid-snapshot .muted{ color:var(--muted); font-size:11px; }
    /* ============================================================
      #5 TOP BLOCKS (Health Plan + Meter + Guidance)
    ============================================================ */
    #fid-snapshot .stack{
      display:grid;
      grid-template-columns:1fr;
      gap:10px;
      margin-bottom:12px;
    }
    #fid-snapshot .statusCard{
      display:flex; gap:10px; align-items:flex-start;
      padding:12px;
      border-radius:14px;
      background:rgba(12,14,25,.55);
      border:1px solid rgba(255,255,255,.08);
      box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
    }
    #fid-snapshot .statusCard.ok{ outline:2px solid rgba(85,211,153,.16); }
    #fid-snapshot .statusCard.warn{ outline:2px solid rgba(249,199,79,.16); }
    #fid-snapshot .statusCard.bad{ outline:2px solid rgba(255,107,107,.16); }
    #fid-snapshot .meter{
      height:14px;
      border-radius:999px;
      overflow:hidden;
      background:rgba(11,14,26,.55);
      border:1px solid rgba(255,255,255,.08);
      box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
    }
    #fid-snapshot .meter > div{
      height:100%;
      width:0%;
      background:linear-gradient(90deg,var(--accent2),var(--warn),var(--bad));
      transition:width .18s ease;
    }
    #fid-snapshot .note{ color:var(--muted); font-size:12px; line-height:1.55; }
    #fid-snapshot .guidance{
      border-radius:14px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(12,14,25,.55);
      padding:12px;
      box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
    }
    #fid-snapshot .guidance h3{
      margin:0 0 8px;
      font-size:16px;
      font-weight:900;
      letter-spacing:.3px;
    }
    /* ============================================================
      #6 KPI GRID (6 boxes)
    ============================================================ */
    #fid-snapshot .kpi{
      display:grid;
      grid-template-columns:repeat(6,minmax(0,1fr));
      gap:12px;
      margin:12px 0 12px;
    }
    @media (max-width:1100px){ #fid-snapshot .kpi{ grid-template-columns:repeat(3,minmax(0,1fr)); } }
    @media (max-width:640px){ #fid-snapshot .kpi{ grid-template-columns:1fr; } }
    #fid-snapshot .k{
      background:rgba(12,14,25,.65);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:12px;
      box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
      min-width:0;
    }
    #fid-snapshot .k small{
      display:block;
      color:var(--muted);
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
    }
    #fid-snapshot .k b{
      display:block;
      margin-top:7px;
      font-size:16px;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    #fid-snapshot b.good{ color:var(--ok) }
    #fid-snapshot b.warn{ color:var(--warn) }
    #fid-snapshot b.bad{ color:var(--bad) }
    #fid-snapshot b.neutral{ color:#cfd5ff }
    /* ============================================================
      #7 ADVANCED DASHBOARD (visuals)
    ============================================================ */
    #fid-snapshot .dash{
      display:grid;
      grid-template-columns:minmax(0,1.05fr) minmax(0,.95fr);
      gap:12px;
      margin-top:12px;
      align-items:start;
    }
    @media(max-width:980px){ #fid-snapshot .dash{ grid-template-columns:1fr; } }
    #fid-snapshot .card-mini{
      background:
        radial-gradient(120% 140% at 15% 0%, rgba(142,243,197,.08), transparent 60%),
        linear-gradient(180deg, rgba(16,20,38,.85), rgba(11,14,26,.35));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px;
      padding:12px;
      box-shadow:0 14px 32px rgba(0,0,0,.45);
      position:relative;
      overflow:hidden;
      min-width:0;
    }
    #fid-snapshot .card-mini h4{
      margin:0 0 8px;
      font-size:14px;
      font-weight:900;
      letter-spacing:.2px;
    }
    #fid-snapshot .chart-holder{
      position:relative;
      height: clamp(180px, 34vh, 360px);
      width:100%;
      display:block;
      overflow:hidden;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.06);
      background:rgba(11,14,26,.35);
    }
    #fid-snapshot canvas{ width:100% !important; height:100% !important; display:block; }
    #fid-snapshot .miniGrid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media(max-width:980px){ #fid-snapshot .miniGrid{ grid-template-columns:1fr; } }
    /* ============================================================
      #8 LOCK FROST
    ============================================================ */
    #fid-snapshot .frost{
      position:absolute;
      inset:0;
      border-radius:12px;
      background:rgba(12,14,25,0.58);
      backdrop-filter:blur(7px) saturate(1.10);
      -webkit-backdrop-filter:blur(7px) saturate(1.10);
      border:1px solid rgba(255,255,255,0.10);
      display:grid;
      place-items:center;
      opacity:1;
      pointer-events:auto;
      transition:opacity .25s;
    }
    #fid-snapshot.unlocked .frost{
      opacity:0;
      pointer-events:none;
    }
    #fid-snapshot .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      background:rgba(12,14,25,.70);
      border:1px solid rgba(255,255,255,.12);
      border-radius:999px;
      font-size:12px;
      color:#cfd5ff;
      box-shadow:0 10px 22px rgba(0,0,0,.35);
    }
    #fid-snapshot .chip b{ color:var(--accent); font-weight:900; }
    /* ============================================================
      #9 ASSUMPTIONS
    ============================================================ */
    #fid-snapshot .blk{
      margin-top:12px;
      background:
        radial-gradient(120% 140% at 0% 0%, rgba(106,167,255,.09), transparent 55%),
        linear-gradient(180deg, rgba(16,20,38,.78), rgba(11,14,26,.35));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px;
      padding:14px;
      box-shadow:0 14px 30px rgba(0,0,0,.45);
      position:relative;
      overflow:hidden;
    }
    #fid-snapshot .blk h3{ margin:0 0 6px; font-size:16px; font-weight:900; }
  </style>
        <!--  ============================================================
    FULL-BLEED WRAPPER (NEW)
  ============================================================  -->
        <div class="fid-breakout">
          <div class="wrap">
            <div class="card">
              <!--  TOP STRIP  -->
              <div class="topbar">
                <div class="top-left">
                  <span class="pill"><span id="t-dot" class="dot"></span><span style="letter-spacing:.08em;text-transform:uppercase;font-size:11px;color:var(--muted)">Status</span>&nbsp;<b id="t-status">—</b></span>
                  <div class="bluf" id="t-bluf">BLUF: Enter values in the planner above.</div>
                </div>
                <div class="actions">
                  <button class="btn ghost" id="t-reset">Reset</button>
                  <button class="btn" id="t-update">Update</button>
                </div>
              </div>
              <!--  KEY ROW  -->
              <div class="keyrow">
                <div class="kbox">
                  <label>ENTER ACTIVATION KEY</label>
                  <input id="fid-key" class="input" placeholder="e.g., 9563379087">
                  <div class="muted">Unlock advanced visuals + full notes. <span style="color:var(--accent)">Hint: 956-337-9087</span></div>
                </div>
                <span class="badge"><span id="fid-dot" class="dot"></span><b id="fid-grade">Locked</b></span>
              </div>
              <!--  TOP STACK  -->
              <div class="stack">
                <div class="statusCard ok" id="statusBox">
                  <span id="statusDot" class="dot" style="background:var(--ok)"></span>
                  <div style="min-width:0">
                    <div style="font-weight:900" id="statusTitle">Healthy Plan</div>
                    <div class="note" id="statusMsg">You remain cash-flow positive after expenses, savings, and housing.</div>
                  </div>
                </div>
                <div>
                  <div class="meter">
                    <div id="meterFill"></div>
                  </div>
                  <div class="note" id="meterNote" style="margin-top:6px">
                    Meter shows share of income consumed by <b>Expenses + Savings + Housing</b>. Under 70% comfortable, 70–85% caution, above 85% risky.
                  </div>
                </div>
                <div class="guidance">
                  <h3>Fiduciary Guidance</h3>
                  <div id="fid-guidance" class="note">Enter key to unlock.</div>
                </div>
              </div>
              <!--  6 KPI BOXES  -->
              <div class="kpi">
                <div class="k"><small>Disposable After Housing</small><b id="k-after" class="neutral">$0</b></div>
                <div class="k"><small>Housing Share of Income</small><b id="k-hshare">0%</b></div>
                <div class="k"><small>Total Committed Share</small><b id="k-tshare">0%</b></div>
                <div class="k"><small>DTI (rough)</small><b id="k-dti">0%</b></div>
                <div class="k"><small>LTV</small><b id="k-ltv">0%</b></div>
                <div class="k"><small>Credit Score → APR</small><b id="k-score">—</b></div>
              </div>
              <!--  ADVANCED DASHBOARD  -->
              <div class="dash">
                <div class="card-mini">
                  <h4>Allocation (Income → Where It Goes)</h4>
                  <div class="chart-holder">
                    <canvas id="ch-alloc"></canvas>
                    <div class="frost"><span class="chip">🔒 Locked <b>House of SaSS</b></span></div>
                  </div>
                  <div class="muted" style="margin-top:6px">Expenses • Savings • Housing • Disposable</div>
                </div>
                <div class="miniGrid">
                  <div class="card-mini">
                    <h4>Ratios Dashboard</h4>
                    <div class="chart-holder" style="height: clamp(180px, 26vh, 300px);">
                      <canvas id="ch-ratios"></canvas>
                      <div class="frost"><span class="chip">🔒 Locked <b>House of SaSS</b></span></div>
                    </div>
                    <div class="muted" style="margin-top:6px">Housing, Committed, DTI, LTV, Savings, Buffer</div>
                  </div>
                  <div class="card-mini">
                    <h4>Stress Test (Payment Sensitivity)</h4>
                    <div class="chart-holder" style="height: clamp(180px, 26vh, 300px);">
                      <canvas id="ch-stress"></canvas>
                      <div class="frost"><span class="chip">🔒 Locked <b>House of SaSS</b></span></div>
                    </div>
                    <div class="muted" style="margin-top:6px">Disposable after housing at -1%, base, +1% APR</div>
                  </div>
                </div>
                <div class="card-mini" style="grid-column:1 / -1;">
                  <h4>Itemized Monthly Budget (Top Items)</h4>
                  <div class="chart-holder" style="height: clamp(220px, 34vh, 380px);">
                    <canvas id="ch-items"></canvas>
                    <div class="frost"><span class="chip">🔒 Locked <b>House of SaSS</b></span></div>
                  </div>
                  <div class="muted" style="margin-top:6px">Pulled from your saved Planner budget. If empty, we estimate a reasonable breakdown.</div>
                </div>
              </div>
              <!--  ASSUMPTIONS  -->
              <div class="blk">
                <h3>Assumptions & Notes</h3>
                <div id="fid-assump" class="note">Enter key to unlock.</div>
                <div class="frost"><span class="chip">🔒 Locked <b>House of SaSS</b></span></div>
              </div>
              <div class="muted" style="margin-top:10px">Outputs are educational, not advice.</div>
            </div>
          </div>
        </div>
        <!--  Chart.js  -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
        <script>
  (()=> {
    function onReady(fn){
      if (document.readyState === "complete" || document.readyState === "interactive") fn();
      else document.addEventListener("DOMContentLoaded", fn, { once:true });
    }
    onReady(()=>{
      if (window.__FID_SNAPSHOT_V2_MOUNTED__) return;
      window.__FID_SNAPSHOT_V2_MOUNTED__ = true;
      const UNLOCK_KEY_NUM = "9563379087";
      const $=(q)=>document.querySelector(q);
      const onlyDigits=(s)=> String(s||'').replace(/\D+/g,'');
      const cur=(n,d=0)=> (Number(n)||0).toLocaleString('en-US',{style:'currency',currency:'USD',minimumFractionDigits:d,maximumFractionDigits:d});
      const pct=(x,d=0)=> ((Number(x)||0)*100).toFixed(d)+'%';
      function pmti(P,r,n){ if(r===0) return P/n; const x=Math.pow(1+r,n); return P*(r*x)/(x-1); }
      function read(id){
        const el = document.getElementById(id);
        return Number.parseFloat((el?.value||'0'))||0;
      }
      function scoreAPR(s){
        s=Number(s)||720;
        if(s>=780) return 6.50; if(s>=760) return 6.75; if(s>=720) return 7.00; if(s>=700) return 7.20;
        if(s>=680) return 7.35; if(s>=660) return 7.85; if(s>=640) return 8.25; if(s>=620) return 9.25; return 9.95;
      }
      function snapshot(customApr=null){
        const income   = read('in-total') + read('in-addl');
        const expenses = read('ex-core') + read('ex-disc');
        const saveRate = (Number(document.getElementById('save-rate')?.value)||0)/100;
        const savings  = Math.max(0, income * saveRate);
        const price = read('h-price');
        const dpPct = (Number(document.getElementById('dp-slider')?.value)||0)/100;
        const dpAmt = Math.max(0, price * dpPct);
        const loan  = Math.max(0, price - dpAmt);
        const score = Number(document.getElementById('cs-slider')?.value)||720;
        const inferredAPR = scoreAPR(score);
        const apr = (customApr!==null) ? customApr : (Number(document.getElementById('h-rate')?.value)||inferredAPR);
        const termY = Number(document.getElementById('h-term')?.value)||30;
        const mRate = (apr||0)/100/12;
        const pAndI = loan>0 ? pmti(loan, mRate, termY*12) : 0;
        const tihoa = read('h-tihoa');
        const pmi   = read('h-pmi');
        const housing = pAndI + tihoa + pmi;
        const freePost = income - expenses - savings - housing;
        const housingShare = income>0 ? housing/income : 0;
        const totalShare   = income>0 ? (expenses + savings + housing)/income : 0;
        const dti          = income>0 ? (expenses + housing)/income : 0;
        const ltv          = price>0 ? (loan/price) : 0;
        return {income,expenses,savings,freePost,housing,housingShare,totalShare,dti,price,dpPct,dpAmt,loan,score,apr,inferredAPR,termY,ltv,tihoa,pmi,pAndI};
      }
      function locked(){
        const entered = onlyDigits(($('#fid-key')?.value||'').trim());
        return entered !== UNLOCK_KEY_NUM;
      }
      function renderLockedState(){
        const root = document.getElementById('fid-snapshot');
        if (!root) return;
        if (locked()) root.classList.remove('unlocked');
        else root.classList.add('unlocked');
        if(locked()){
          $('#fid-grade').textContent='Locked';
          $('#fid-dot').style.background='#888';
        }
      }
      function localGrade(s){
        let g=92;
        if(s.totalShare>=0.85) g-=30; else if(s.totalShare>=0.70) g-=15; else g+=4;
        if(s.housingShare>0.40) g-=18; else if(s.housingShare>0.33) g-=8; else g+=4;
        if(s.freePost<0) g-=30; else if((s.freePost/(s.income||1))<0.10) g-=10; else if((s.freePost/(s.income||1))>=0.20) g+=4;
        const sr=s.savings/(s.income||1); if(sr<0.10) g-=8; else if(sr>=0.20) g+=4;
        if(s.score>=760) g+=3; else if(s.score<640) g-=12; else if(s.score<620) g-=18;
        if(s.ltv>0.95) g-=14; else if(s.ltv>0.80) g-=6; else g+=3;
        g=Math.max(0,Math.min(100,g));
        const letter = g>=98?'A+': g>=92?'A': g>=88?'A-'
                     : g>=82?'B+': g>=76?'B': g>=72?'B-'
                     : g>=66?'C+': g>=60?'C': g>=55?'C-'
                     : g>=50?'D+': g>=45?'D':'F';
        return {g,letter};
      }
      function buildElena(s){
        const sr = s.income>0 ? s.savings/s.income : 0;
        const buffer = s.income>0 ? s.freePost/s.income : 0;
        const blocks = [];
        blocks.push(`Elena’s read — calm, clean, and brutally useful:\n`);
        blocks.push(`Targets • Housing ≤31% • DTI ≤36% (cap ≈43%) • Savings ≥20% • Buffer ≥15% • LTV ≤80%.\n`);
        const strong=[], watch=[], risk=[], next=[];
        if (s.housingShare<=0.31) strong.push(`Housing at ${(s.housingShare*100).toFixed(0)}% — inside the preferred ≤31% band.`);
        else { watch.push(`Housing at ${(s.housingShare*100).toFixed(0)}% — above comfort; buffer gets squeezed fast.`); next.push(`Reduce price or increase down payment until housing ≤31%.`); }
        const dti=s.dti;
        if(dti<=0.36) strong.push(`DTI ${(dti*100).toFixed(0)}% — healthy.`);
        else if(dti<=0.43){ watch.push(`DTI ${(dti*100).toFixed(0)}% — workable but tight.`); next.push(`Trim recurring debts (even $100/mo helps approval lanes).`); }
        else { risk.push(`DTI ${(dti*100).toFixed(0)}% — outside typical approval lanes.`); next.push(`Lower purchase price or pay down revolving balances to get DTI <43%.`); }
        if(sr>=0.20) strong.push(`Savings ${(sr*100).toFixed(0)}% — strong cushion.`);
        else { risk.push(`Savings ${(sr*100).toFixed(0)}% — thin cushion for repairs/move-in variance.`); next.push(`Pre-close sprint: raise savings +8–10% for 3–4 months.`); }
        if(buffer>=0.15) strong.push(`Post-housing buffer ${(buffer*100).toFixed(0)}% (${cur(s.freePost)}) — gives flexibility.`);
        else if(buffer>0){ watch.push(`Post-housing buffer ${(buffer*100).toFixed(0)}% (${cur(s.freePost)}) — lean.`); next.push(`Aim for ≥15% buffer before you lock a payment.`); }
        else { risk.push(`Negative after housing (${cur(s.freePost)}) — not sustainable.`); next.push(`Reduce payment or rebuild buffer before proceeding.`); }
        if(s.ltv<=0.80) strong.push(`LTV ${(s.ltv*100).toFixed(0)}% — strong equity start.`);
        else watch.push(`LTV ${(s.ltv*100).toFixed(0)}% — PMI likely; plan removal/refi at ≤80%.`);
        const aprUsed=(s.apr||s.inferredAPR).toFixed(2);
        watch.push(`Score ${s.score} → ~${aprUsed}%. Small improvements can cut payment.`);
        blocks.push(`✅ Strong:\n— ${strong.join('\n— ')}\n`);
        blocks.push(watch.length?`⚠️ Watch:\n— ${watch.join('\n— ')}\n`:``);
        blocks.push(risk.length?`❌ Risk:\n— ${risk.join('\n— ')}\n`:``);
        blocks.push(next.length?`🛠️ Next moves:\n— ${next.join('\n— ')}`:``);
        return blocks.filter(Boolean).join('\n');
      }
      function localAssumptions(s){
        return [
          `P&I from loan ${cur(s.loan)} at ${(s.apr||s.inferredAPR).toFixed(2)}% for ${s.termY} yrs.`,
          `Taxes/Insurance/HOA entered: ${cur(s.tihoa)}/mo.`,
          `PMI entered: ${cur(s.pmi)}/mo.`,
          `Down payment ${(s.dpPct*100).toFixed(0)}% → ${cur(s.dpAmt)}; LTV ${(s.ltv*100).toFixed(0)}%.`,
          `Ratios — Housing ${pct(s.housingShare)}, Total ${pct(s.totalShare)}, DTI ${pct(s.dti)}.`
        ];
      }
      function getItemizedFromStorage(){
        const keys=['realtysass.afford.expenses.rows','va.expenses.rows','planner.itemized.rows','itemizedMonthlyBudget'];
        for(const k of keys){
          try{
            const raw = localStorage.getItem(k);
            if(!raw) continue;
            const arr = JSON.parse(raw)||[];
            const rows = arr.map(r=>({name:String(r.name||r.item||r.label||'Item'), month:Number(r.month||r.monthly||r.amount||0)||0}))
                            .filter(r=>r.month>0);
            if(rows.length) return rows;
          }catch(e){}
        }
        return [];
      }
      const FALLBACK_LABELS = ['Rent','Groceries','Dining','Utilities','Insurance','Transportation','Internet/Phone','Subscriptions','Other'];
      function labelize(rows){
        if(!rows.length) return rows;
        const badCount = rows.filter(r=>!r.name || /^item$/i.test(r.name.trim())).length;
        if(badCount / rows.length >= 0.6){
          const sorted = [...rows].sort((a,b)=>b.month-a.month);
          for(let i=0;i<sorted.length;i++){
            sorted[i].name = FALLBACK_LABELS[Math.min(i, FALLBACK_LABELS.length-1)];
          }
          return sorted;
        }
        return rows;
      }
      function destroyChart(canvasId){
        const ex = window.Chart && Chart.getChart(canvasId);
        if (ex) ex.destroy();
      }
      let chAlloc=null, chRatios=null, chItems=null, chStress=null;
      function initCharts(){
        destroyChart('ch-alloc'); destroyChart('ch-ratios'); destroyChart('ch-items'); destroyChart('ch-stress');
        const cAlloc = document.getElementById('ch-alloc');
        const cRat   = document.getElementById('ch-ratios');
        const cItems = document.getElementById('ch-items');
        const cStress= document.getElementById('ch-stress');
        if(!window.Chart || !cAlloc || !cRat || !cItems || !cStress) return;
        chAlloc = new Chart(cAlloc.getContext('2d'),{
          type:'doughnut',
          data:{ labels:['Expenses','Savings','Housing','Disposable'],
            datasets:[{ data:[0,0,0,1], backgroundColor:['#6aa7ff','#8ef3c5','#f9c74f','#55d399'] }] },
          options:{
            plugins:{ legend:{ labels:{ color:'#cfd5ff' } } },
            cutout:'62%',
            responsive:true,
            maintainAspectRatio:false
          }
        });
        chRatios = new Chart(cRat.getContext('2d'),{
          type:'bar',
          data:{
            labels:['Housing','Committed','DTI','LTV','Savings','Buffer'],
            datasets:[{ label:'%', data:[0,0,0,0,0,0], backgroundColor:'#6aa7ff' }]
          },
          options:{
            plugins:{ legend:{ labels:{ color:'#cfd5ff' } }, tooltip:{ callbacks:{ label:(ctx)=> `${ctx.raw.toFixed(1)}%` } } },
            scales:{
              x:{ ticks:{ color:'#cfd5ff' } },
              y:{ ticks:{ color:'#cfd5ff' }, min:0, max:100 }
            },
            responsive:true,
            maintainAspectRatio:false
          }
        });
        chItems = new Chart(cItems.getContext('2d'),{
          type:'bar',
          data:{ labels:[], datasets:[{ label:'Monthly $', data:[], backgroundColor:'#8ef3c5' }] },
          options:{
            indexAxis:'y',
            plugins:{ legend:{ labels:{ color:'#cfd5ff' } }, tooltip:{ callbacks:{ label:(ctx)=> cur(ctx.raw) } } },
            scales:{ x:{ ticks:{ color:'#cfd5ff' } }, y:{ ticks:{ color:'#cfd5ff' } } },
            responsive:true,
            maintainAspectRatio:false
          }
        });
        chStress = new Chart(cStress.getContext('2d'),{
          type:'line',
          data:{
            labels:['APR -1%','APR Base','APR +1%'],
            datasets:[{ label:'Disposable $', data:[0,0,0], borderColor:'#8ef3c5', tension:0.25 }]
          },
          options:{
            plugins:{ legend:{ labels:{ color:'#cfd5ff' } }, tooltip:{ callbacks:{ label:(ctx)=> cur(ctx.raw) } } },
            scales:{ x:{ ticks:{ color:'#cfd5ff' } }, y:{ ticks:{ color:'#cfd5ff' } } },
            responsive:true,
            maintainAspectRatio:false
          }
        });
        const holders = document.querySelectorAll('#fid-snapshot .chart-holder');
        const ro = new ResizeObserver(()=>{ chAlloc?.resize(); chRatios?.resize(); chItems?.resize(); chStress?.resize(); });
        holders.forEach(h=> ro.observe(h));
      }
      function updateItemizedBars(s){
        if(!chItems) return;
        let rows = labelize(getItemizedFromStorage());
        if(!rows.length){
          rows = [
            {name:'Housing', month:s.housing},
            {name:'Groceries', month:Math.round(s.expenses*0.28)},
            {name:'Dining', month:Math.round(s.expenses*0.17)},
            {name:'Utilities', month:Math.round(s.expenses*0.12)},
            {name:'Insurance', month:Math.round(s.expenses*0.10)},
            {name:'Transportation', month:Math.round(s.expenses*0.15)},
            {name:'Internet/Phone', month:Math.round(s.expenses*0.10)},
            {name:'Subscriptions', month:Math.round(s.expenses*0.08)}
          ].filter(r=>r.month>0);
        }
        rows.sort((a,b)=> b.month - a.month);
        const top = rows.slice(0,8);
        const rest = rows.slice(8);
        const other = rest.reduce((m,r)=>m+r.month,0);
        chItems.data.labels = top.map(r=>r.name).concat(other>0?['Other']:[]);
        chItems.data.datasets[0].data = top.map(r=>r.month).concat(other>0?[other]:[]);
        chItems.update();
      }
      function updateStress(){
        if(!chStress) return;
        const base = Number(document.getElementById('h-rate')?.value) || scoreAPR(Number(document.getElementById('cs-slider')?.value)||720);
        const low = Math.max(0, base - 1);
        const high = base + 1;
        const sLow = snapshot(low);
        const sBase = snapshot(base);
        const sHigh = snapshot(high);
        chStress.data.datasets[0].data = [Math.round(sLow.freePost), Math.round(sBase.freePost), Math.round(sHigh.freePost)];
        chStress.update();
      }
      function paint(){
        const s = snapshot();
        const after=$('#k-after');
        const bufferPct = s.income>0 ? (s.freePost/s.income) : 0;
        after.textContent = s.freePost>=0 ? cur(s.freePost) : ('-'+cur(Math.abs(s.freePost)));
        after.className = s.freePost<0 ? 'bad' : (bufferPct>=0.20 ? 'good' : (bufferPct>=0.10 ? 'warn' : 'neutral'));
        $('#k-hshare').textContent = pct(s.housingShare,0);
        $('#k-tshare').textContent = pct(s.totalShare,0);
        $('#k-dti').textContent = pct(s.dti,0);
        $('#k-ltv').textContent = pct(s.ltv,0);
        const score = Number(document.getElementById('cs-slider')?.value)||720;
        const aprUsed = Number(document.getElementById('h-rate')?.value) || scoreAPR(score);
        $('#k-score').textContent  = `${score} → ${aprUsed.toFixed(2)}%`;
        const g = localGrade({...s,score});
        $('#fid-grade').textContent = `${g.letter} • snapshot`;
        $('#fid-dot').style.background =
          (g.letter[0]==='A'||g.letter[0]==='B') ? '#55d399' : (g.letter[0]==='C' ? '#f9c74f' : '#ff6b6b');
        const totalShare = s.totalShare || 0;
        $('#meterFill').style.width = Math.max(0,Math.min(1,totalShare))*100 + '%';
        let title='Healthy Plan', msg='You remain cash-flow positive after expenses, savings, and housing.', cls='ok';
        if (totalShare>=0.85 || s.freePost<0){
          title='Risky: Overcommitted';
          msg='This scenario likely overextends cash flow. Reduce price/rate/expenses.';
          cls='bad';
        } else if (totalShare>=0.70){
          title='Caution Zone';
          msg='Budget is tight. Aim for ≥15% buffer after all costs.';
          cls='warn';
        }
        const sb=$('#statusBox');
        sb.classList.remove('ok','warn','bad'); sb.classList.add(cls);
        $('#statusTitle').textContent=title;
        $('#statusMsg').textContent=msg;
        $('#t-dot').style.background = (cls==='ok') ? 'var(--ok)' : (cls==='warn' ? 'var(--warn)' : 'var(--bad)');
        $('#t-status').textContent = (cls==='ok') ? 'Healthy' : (cls==='warn' ? 'Caution' : 'Risky');
        const dispTxt = s.freePost>=0 ? cur(s.freePost) : ('-'+cur(Math.abs(s.freePost)));
        $('#t-bluf').textContent = `BLUF: ${title}. Disposable: ${dispTxt}.`;
        if(!chAlloc || !chRatios || !chItems || !chStress) initCharts();
        if(chAlloc){
          chAlloc.data.datasets[0].data = [s.expenses, s.savings, s.housing, Math.max(0,s.freePost)];
          chAlloc.update();
        }
        if(chRatios){
          const savingsPct = s.income>0 ? (s.savings/s.income)*100 : 0;
          const buffer = s.income>0 ? (s.freePost/s.income)*100 : 0;
          chRatios.data.datasets[0].data = [
            s.housingShare*100,
            s.totalShare*100,
            s.dti*100,
            s.ltv*100,
            savingsPct,
            buffer
          ].map(v=> Math.max(0,Math.min(100, Number(v)||0)));
          chRatios.update();
        }
        updateItemizedBars(s);
        updateStress();
        if(!locked()){
          $('#fid-guidance').innerHTML =
            `<div style="white-space:pre-line; line-height:1.55">${buildElena(s)}</div>`;
          $('#fid-assump').innerHTML =
            '<ul style="margin:8px 0 0 18px">' +
              localAssumptions(s).map(x=>`<li style="margin:6px 0">${x}</li>`).join('') +
            '</ul>';
        } else {
          $('#fid-guidance').textContent = 'Enter key to unlock.';
          $('#fid-assump').textContent = 'Enter key to unlock.';
        }
        renderLockedState();
      }
      $('#fid-key')?.addEventListener('input', paint);
      window.addEventListener('realtysass:affordability-updated', paint);
      ['in-total','in-addl','ex-core','ex-disc','save-rate','cs-slider','h-price','dp-slider','h-rate','h-term','h-tihoa','h-pmi']
        .forEach(id=>{
          const n=document.getElementById(id);
          if(n) n.addEventListener('input', paint);
        });
      $('#t-update')?.addEventListener('click', ()=>{
        document.getElementById('btn-calc')?.click();
        paint();
      });
      $('#t-reset')?.addEventListener('click', ()=>{
        document.getElementById('btn-clear')?.click();
        paint();
      });
      window.addEventListener('storage', (ev)=>{
        if(['realtysass.afford.expenses.rows','va.expenses.rows','planner.itemized.rows','itemizedMonthlyBudget'].includes(ev.key)) paint();
      });
      initCharts();
      paint();
    });
  })();
  </script>
      </div>
    </div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=697e270fb126ef5fe6610167" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
</body>
</html>