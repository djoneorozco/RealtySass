<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Mon Sep 15 2025 14:38:18 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="68baf125d2f8b9d4da47933d" data-wf-site="68ab0c767e65bfdde9efba3b" lang="en">
<head>
  <meta charset="utf-8">
  <title>Affordability Planner 2</title>
  <meta content="Explore luxury on High-End Realty&#x27;s sleek site. Customize our responsive real estate Webflow template effortlessly. Connect to our powerful CMS and E-commerce today." name="description">
  <meta content="Affordability Planner 2" property="og:title">
  <meta content="Explore luxury on High-End Realty&#x27;s sleek site. Customize our responsive real estate Webflow template effortlessly. Connect to our powerful CMS and E-commerce today." property="og:description">
  <meta content="https://cdn.prod.website-files.com/6688dd0add61af9d990077eb/66def8f549c69f8ce8ca8210_SEO.jpg" property="og:image">
  <meta content="Affordability Planner 2" property="twitter:title">
  <meta content="Explore luxury on High-End Realty&#x27;s sleek site. Customize our responsive real estate Webflow template effortlessly. Connect to our powerful CMS and E-commerce today." property="twitter:description">
  <meta content="https://cdn.prod.website-files.com/6688dd0add61af9d990077eb/66def8f549c69f8ce8ca8210_SEO.jpg" property="twitter:image">
  <meta property="og:type" content="website">
  <meta content="summary_large_image" name="twitter:card">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/new-orozco-realty.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Varela:400","Vollkorn:400,400italic,700,700italic","Great Vibes:400","Merriweather:300,300italic,400,400italic,700,700italic,900,900italic","Changa One:400,400italic","Gilda Display:regular","Barlow:200,200italic,300,300italic,regular,italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Barlow Condensed:100,100italic,200,200italic,300,300italic,regular,italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Material Symbols Outlined:100,200,300,regular,500,600,700"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.png" rel="apple-touch-icon">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
  :root{
    --bg:#0f1220; --card:#181b2e; --ink:#e9ecff; --muted:#a8b0d6;
    --accent:#6aa7ff; --accent-2:#8ef3c5; --danger:#ff6b6b;
    --ok:#55d399; --warning:#f9c74f; --chip:#222642;
    --shadow:0 10px 24px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.04);
    --radius:18px;
  }
  html,body{height:100%;}
  body{
    margin:0; background: radial-gradient(1200px 800px at 10% -10%, rgba(106,167,255,0.15), transparent 50%),
                             radial-gradient(900px 700px at 110% 20%, rgba(142,243,197,0.12), transparent 50%),
                             var(--bg);
    color:var(--ink); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    -webkit-font-smoothing:antialiased; line-height:1.45;
  }
  .wrap{max-width:1120px; margin:32px auto; padding:0 16px 56px;}
  .header{display:flex; align-items:center; gap:16px; margin-bottom:18px;}
  .logo{width:56px; height:56px; border-radius:14px; display:grid; place-items:center;
    background: linear-gradient(145deg, rgba(106,167,255,0.25), rgba(142,243,197,0.18));
    box-shadow: var(--shadow); font-weight:800; font-size:20px; color:var(--ink);}
  h1{margin:0; font-size:28px; letter-spacing:0.2px;}
  .subtitle{color:var(--muted); margin:6px 0 0; font-size:14px;}
  .grid{display:grid; grid-template-columns:1.1fr 1fr; gap:20px;}
  @media (max-width: 980px){ .grid{ grid-template-columns:1fr; } }
  .card{background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:18px;}
  .card h2{margin:0 0 12px; font-size:18px;}
  .row{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
  @media (max-width:700px){ .row{grid-template-columns:1fr;} }
  .field{display:flex; flex-direction:column; gap:8px;}
  .field label{font-size:12px; color:var(--muted);}
  .input, select, button, .slider{border:1px solid rgba(255,255,255,0.06); background:#0f1220; color:var(--ink);
    border-radius:12px; padding:12px 12px; font-size:14px; outline:none;}
  .btn{cursor:pointer; background:linear-gradient(135deg, var(--accent), #7ec8ff); color:#041125; font-weight:800;}
  .btn.secondary{background:linear-gradient(135deg, #7de9bd, var(--accent-2)); color:#0b1a10;}
  .kpi{display:grid; grid-template-columns: repeat(4, 1fr); gap:14px;}
  @media (max-width:820px){ .kpi{grid-template-columns:1fr 1fr;} }
  .kpi .box{background:#0f1220; border:1px solid rgba(255,255,255,0.06); border-radius:16px; padding:14px;}
  .kpi .box small{color:var(--muted)}
  .kpi .box b{display:block; margin-top:6px; font-size:18px;}
  .meter{height:14px; border-radius:999px; background:#0b0f23; border:1px solid rgba(255,255,255,0.06); overflow:hidden;}
  .meter div{height:100%;}
  .legend{display:flex; gap:12px; flex-wrap:wrap;}
  .legend .tag{display:inline-flex; align-items:center; gap:8px; font-size:12px; color:var(--muted)}
  .legend .dot{width:10px; height:10px; border-radius:50%}
  .status{display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; background:#0f1326; border:1px solid rgba(255,255,255,0.06)}
  .status.ok{outline:2px solid rgba(85,211,153,0.25)}
  .status.warn{outline:2px solid rgba(249,199,79,0.25)}
  .status.bad{outline:2px solid rgba(255,107,107,0.25)}
  .note{color:var(--muted); font-size:12px}
  .footer{margin-top:26px; color:var(--muted); font-size:12px; text-align:center}
</style>
</head>
<body>
  <section class="section">
    <section>
      <section>
        <footer class="hp_footer_sect">
          <div class="hp_footer_wrapper">
            <div class="container-4">
              <div class="hp_footer_copy_right_box fade-in-top">
                <div class="hp-hero-content-top">
                  <h1 class="hp-hero-title">Orozco Realty&#x27;s <br> <span class="hp_hero_banner_title_span hp-hero-title-span">Affordability Planner</span></h1>
                  <p class="hp_title_dis hp-hero-para">We believe Financial Accuracy &amp; Transparency  are crucial first steps in your Home-Buying Journey. <br>Additional A.I Financial Analysis are also available for Free to all our Subscribed Guests. </p>
                </div>
              </div>
            </div>
            <a href="../features/ask-elena.html" class="link-block w-inline-block"></a>
          </div>
        </footer>
      </section>
    </section>
  </section>
  <section class="section-42">
    <section class="section-51">
      <div class="hp_hero_banner_wrapper-3 hp-hero-inner">
        <div class="w-layout-blockcontainer container-4 w-container">
          <div data-w-id="678f1e9c-4a47-3777-0466-85c36211633c" style="-webkit-transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);opacity:0" class="hp-hero-content-wrap">
            <div class="hp-hero-content-top">
              <div class="code-embed-3 w-embed w-script"><!--  Affordability Planner — single-file, safe, collision-proof  -->
                <style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
  :root{
    --bg:#0f1220; --card:#181b2e; --ink:#e9ecff; --muted:#a8b0d6;
    --accent:#6aa7ff; --accent-2:#8ef3c5; --danger:#ff6b6b;
    --ok:#55d399; --warning:#f9c74f; --chip:#222642;
    --shadow:0 10px 24px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.04);
    --radius:18px;
  }
  .va-wrap{max-width:1344px;margin:32px auto;padding:0 16px 56px;color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .va-header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
  .va-logo{width:56px;height:56px;border-radius:14px;display:grid;place-items:center;background:linear-gradient(145deg,rgba(106,167,255,.25),rgba(142,243,197,.18));box-shadow:var(--shadow);font-weight:800;font-size:20px}
  .va-h1{margin:0;font-size:28px;letter-spacing:.2px}
  .va-sub{color:var(--muted);margin:6px 0 0;font-size:14px}
  .va-grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px}
  @media (max-width:980px){.va-grid{grid-template-columns:1fr}}
  .va-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
  .va-card h2{margin:0 0 12px;font-size:18px}
  .va-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:700px){.va-row{grid-template-columns:1fr}}
  .va-field{display:flex;flex-direction:column;gap:8px}
  .va-field label{font-size:12px;color:var(--muted)}
  .va-input,.va-select,.va-slider,.va-btn{border:1px solid rgba(255,255,255,.06);background:#0f1220;color:var(--ink);border-radius:12px;padding:12px;font-size:14px;outline:none}
  .va-select{appearance:none}
  .va-btn{cursor:pointer;background:linear-gradient(135deg,var(--accent),#7ec8ff);color:#041125;font-weight:800}
  .va-btn.secondary{background:linear-gradient(135deg,#7de9bd,var(--accent-2));color:#0b1a10}
  .va-btn.ghost{background:#0f1220;border:1px dashed rgba(255,255,255,.18);color:var(--ink)}
  .toggle{display:flex;align-items:center;gap:10px;margin-top:6px}
  .hidden{display:none}
  .va-kpi{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:12px}
  .va-kpi .box{background:#0f1220;border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:12px}
  .va-kpi .box small{color:var(--muted);font-size:11px}
  .va-kpi .box b{display:block;margin-top:6px;font-size:16px}
  b.good{color:#55d399} b.warn{color:#f9c74f} b.bad{color:#ff6b6b} b.neutral{color:var(--ink)}
  .va-legend{display:flex;gap:12px;flex-wrap:wrap;margin-top:8px}
  .va-tag{display:inline-flex;align-items:center;gap:8px;font-size:12px;color:var(--muted)}
  .va-dot{width:10px;height:10px;border-radius:50%}
  .va-status{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:12px;background:#0f1326;border:1px solid rgba(255,255,255,.06);margin-top:16px}
  .va-status.ok{outline:2px solid rgba(85,211,153,.25)} .va-status.warn{outline:2px solid rgba(249,199,79,.25)} .va-status.bad{outline:2px solid rgba(255,107,107,.25)}
  .va-meter{height:14px;border-radius:999px;background:#0b0f23;border:1px solid rgba(255,255,255,.06);overflow:hidden;margin-top:16px}
  .va-meter div{height:100%}
  .va-note{color:var(--muted);font-size:12px}
  .va-footer{margin-top:26px;color:var(--muted);font-size:12px;text-align:center}
  .va-mt8{margin-top:8px}.va-mt12{margin-top:12px}.va-mt16{margin-top:16px}.va-mt20{margin-top:20px}
  .bp-panel{margin-top:10px;border:1px dashed rgba(255,255,255,.12);border-radius:12px;padding:12px;background:#0f1326}
  .bp-row{display:grid;grid-template-columns:110px 1fr 140px 80px;gap:8px;align-items:center}
  @media(max-width:720px){.bp-row{grid-template-columns:1fr}}
  .bp-table{width:100%;border-collapse:separate;border-spacing:0 8px;margin-top:8px}
  .bp-tr{background:#0f1220;border:1px solid rgba(255,255,255,.08);border-radius:10px}
  .bp-td,.bp-th{padding:8px 10px;font-size:13px}
  .bp-controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .bp-chip{padding:6px 10px;border-radius:999px;background:#0f1220;border:1px solid rgba(255,255,255,.12);font-size:12px}
</style>
                <div class="va-wrap" id="va-planner">
                  <div class="va-header">
                    <div class="va-logo">VA</div>
                    <div>
                      <h1 class="va-h1">Affordability Planner</h1>
                      <p class="va-sub">Enter income & expenses, set savings, preview housing. Credit score and down payment sliders update APR & payment instantly.</p>
                    </div>
                  </div>
                  <div class="va-kpi va-mt12" id="kpis">
                    <div class="box"><small>Total Monthly Income</small><b id="kpi-income">$0</b></div>
                    <div class="box"><small>Total Monthly Expenses</small><b id="kpi-expenses">$0</b></div>
                    <div class="box"><small>Mortgage Estimate</small><b id="kpi-mortgage">$0</b></div>
                    <div class="box"><small>Target Savings</small><b id="kpi-savings">$0</b></div>
                    <div class="box"><small>Disposable Income (after house)</small><b id="kpi-disposable" class="neutral">$0</b></div>
                  </div>
                  <div class="va-grid va-mt20">
                    <!--  LEFT  -->
                    <div class="va-card">
                      <h2>1) Income</h2>
                      <div class="va-row va-mt8">
                        <div class="va-field">
                          <label>Total Monthly Income ($)</label>
                          <input class="va-input" id="in-total" type="number" min="0" step="1" placeholder="e.g., 5200">
                          <small class="va-note">If you use Military Pay below, this auto-fills (Base + BAS + BAH).</small>
                        </div>
                        <div class="va-field">
                          <label>Additional Income ($)</label>
                          <input class="va-input" id="in-addl" type="number" min="0" step="1" placeholder="Spouse/side income">
                        </div>
                      </div>
                      <div class="toggle">
                        <button class="va-btn ghost" id="btn-mil">▼ Military Pay (optional)</button>
                        <small class="va-note" id="mil-msg">DFAS ’25 Base + BAS by rank + BAH for 78236 (San Antonio).</small>
                      </div>
                      <div id="mil-panel" class="hidden va-mt8">
                        <div class="va-row">
                          <div class="va-field"><label>Rank</label><select class="va-select" id="sel-rank"></select></div>
                          <div class="va-field"><label>Years in Service</label><select class="va-select" id="sel-years"></select></div>
                          <div class="va-field"><label>Dependents</label>
                            <select class="va-select" id="sel-deps">
                              <option value="with" selected="">With Dependents</option>
                              <option value="without">Without Dependents</option>
                            </select>
                          </div>
                          <div class="va-field"><label>ZIP / Duty Location</label>
                            <select class="va-select" id="sel-zip">
                              <option value="78236" selected="">78236 – Lackland AFB (San Antonio, TX)</option>
                              <option value="other">Other (BAH not auto-filled)</option>
                            </select>
                          </div>
                        </div>
                        <div class="va-note va-mt8" id="mil-breakdown">—</div>
                        <div class="va-row va-mt8" style="grid-template-columns:1fr auto">
                          <div></div>
                          <button class="va-btn secondary" id="btn-mil-update">Update Monthly income</button>
                        </div>
                      </div>
                      <h2 class="va-mt16">2) Expenses</h2>
                      <div class="va-row va-mt8">
                        <div class="va-field"><label>Monthly Expenses ($)</label><input class="va-input" id="ex-core" type="number" min="0" step="1" placeholder="Rent, utilities, debt, etc."></div>
                        <div class="va-field"><label>Discretionary Expenses ($)</label><input class="va-input" id="ex-disc" type="number" min="0" step="1" placeholder="Dining, travel, subscriptions..."></div>
                      </div>
                      <div class="toggle va-mt8">
                        <button class="va-btn ghost" id="btn-bp">▼ Itemized Monthly Budget (open here)</button>
                        <small class="va-note">Build a detailed budget; totals will prefill above.</small>
                      </div>
                      <div id="bp-panel" class="hidden bp-panel">
                        <div class="bp-row">
                          <select id="bp-cat" class="va-select">
                            <option>Essentials</option>
                            <option>Discretionary</option>
                            <option>Debt</option>
                            <option>Other</option>
                          </select>
                          <input id="bp-name" class="va-input" placeholder="Item name (e.g., Rent, Groceries)">
                          <input id="bp-month" class="va-input" type="number" min="0" step="1" placeholder="Monthly $">
                          <button id="bp-add" class="va-btn">Add</button>
                        </div>
                        <table class="bp-table">
                          <thead>
                            <tr class="bp-tr">
                              <th class="bp-th">Category</th>
                              <th class="bp-th">Item</th>
                              <th class="bp-th">Monthly</th>
                              <th class="bp-th">Annual</th>
                              <th class="bp-th">Del</th>
                            </tr>
                          </thead>
                          <tbody id="bp-body"></tbody>
                        </table>
                        <div class="bp-controls">
                          <span class="bp-chip">Essentials: <b id="bp-t-Essentials">$0</b></span>
                          <span class="bp-chip">Discretionary: <b id="bp-t-Discretionary">$0</b></span>
                          <span class="bp-chip">Debt: <b id="bp-t-Debt">$0</b></span>
                          <span class="bp-chip">Other: <b id="bp-t-Other">$0</b></span>
                          <span class="bp-chip">Total: <b id="bp-t-All">$0</b></span>
                          <button id="bp-load" class="va-btn" style="margin-left:auto">Load Example</button>
                          <button id="bp-save" class="va-btn secondary">Save & Prefill</button>
                        </div>
                        <div class="va-note" id="bp-note" style="margin-top:6px">Not saved yet.</div>
                      </div>
                      <h2 class="va-mt16">3) Savings Target</h2>
                      <div class="va-field va-mt8">
                        <label>Desired Savings Rate <span id="save-rate-label" class="va-chip">15%</span></label>
                        <input class="va-slider" id="save-rate" type="range" min="0" max="40" step="1" value="15">
                        <small class="va-note">Savings comes before house—protect your buffer.</small>
                      </div>
                      <h2 class="va-mt16">4) Home Purchase (What-If)</h2>
                      <div class="va-field va-mt8">
                        <label>Credit Score <span id="cs-label">720 – Good</span></label>
                        <input class="va-slider" id="cs-slider" type="range" min="500" max="850" step="5" value="720">
                      </div>
                      <div class="va-note">Estimated APR from credit score: <b id="apr-label">7.00%</b> (illustrative).</div>
                      <div class="va-row va-mt8">
                        <div class="va-field">
                          <label>Home Price ($)</label>
                          <input class="va-input" id="h-price" type="number" min="0" step="1000">
                        </div>
                        <div class="va-field">
                          <label>Down Payment % <span id="dp-pct-label">20%</span> = <span id="dp-amt-label">$0</span></label>
                          <input class="va-slider" id="dp-slider" type="range" min="0" max="100" step="1" value="20">
                        </div>
                      </div>
                      <div class="va-row va-mt8">
                        <div class="va-field"><label>Interest Rate (APR %)</label><input class="va-input" id="h-rate" type="number" step="0.01" value="7.00"></div>
                        <div class="va-field"><label>Down Payment ($)</label><input class="va-input" id="dp-amt" type="text" disabled=""></div>
                      </div>
                      <div class="va-row va-mt8">
                        <div class="va-field"><label>Term (years)</label><input class="va-input" id="h-term" type="number" min="5" max="40" step="1" value="30"></div>
                        <div class="va-field"><label>Taxes + Insurance + HOA ($/mo)</label><input class="va-input" id="h-tihoa" type="number" min="0" step="1" value="0"></div>
                      </div>
                      <div class="va-row va-mt8">
                        <div class="va-field"><label>Include PMI? ($/mo)</label><input class="va-input" id="h-pmi" type="number" min="0" step="1" value="0"></div>
                        <div class="va-field"><label>&nbsp;</label>
                          <div class="va-note">APR/PMI are illustrative only; verify with your lender.</div>
                        </div>
                      </div>
                      <div class="va-row va-mt16" style="justify-content:flex-end">
                        <button class="va-btn secondary" id="btn-clear">Reset</button>
                        <button class="va-btn" id="btn-calc">Update Calculations</button>
                      </div>
                    </div>
                    <!--  RIGHT  -->
                    <div class="va-card">
                      <h2>Visual Budget</h2>
                      <div class="va-legend">
                        <span class="va-tag"><span class="va-dot" style="background:var(--accent)"></span>Expenses</span>
                        <span class="va-tag"><span class="va-dot" style="background:var(--accent-2)"></span>Savings</span>
                        <span class="va-tag"><span class="va-dot" style="background:var(--warning)"></span>Housing</span>
                        <span class="va-tag"><span class="va-dot" style="background:var(--ok)"></span>Disposable</span>
                      </div>
                      <div class="va-mt12"><canvas id="pie" height="240"></canvas></div>
                      <div class="va-mt16"><canvas id="bars" height="240"></canvas></div>
                      <div class="va-status ok" id="statusBox">
                        <div id="statusDot" class="va-dot" style="width:12px;height:12px;background:var(--ok)"></div>
                        <div>
                          <div id="statusTitle" style="font-weight:800">Healthy Plan</div>
                          <div id="statusMsg" class="va-note">You remain cash-flow positive after expenses, savings, and proposed housing.</div>
                        </div>
                      </div>
                      <div class="va-meter">
                        <div id="meterFill" style="width:0%;background:linear-gradient(90deg,var(--accent),var(--warning),var(--danger));"></div>
                      </div>
                      <small class="va-note">Meter shows share of income consumed by Expenses + Savings + Proposed Housing. Under 70% comfortable, 70–85% caution, above 85% risky.</small>
                      <div class="va-card va-mt16" style="background:#12162b">
                        <h2>Fiduciary Guidance</h2>
                        <div id="fiduciaryText" class="va-note">Enter values to see tailored guidance on risks and recommendations.</div>
                      </div>
                    </div>
                  </div>
                  <div class="va-footer">For education only, not financial advice.</div>
                </div>
                <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
                <script>
(()=>{
  // Guard so this embed never initializes twice
  if (window.__VA_PLANNER_MOUNTED__) return;
  window.__VA_PLANNER_MOUNTED__ = true;
  const $=(q)=>document.querySelector(q);
  const $$=(q)=>Array.from(document.querySelectorAll(q));
  const fmt=(n)=> (Number(n)||0).toLocaleString('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0});
  const clamp01=(x)=>Math.max(0,Math.min(1,x));
  function pmti(P,r,n){ if(r===0) return P/n; const x=Math.pow(1+r,n); return P*(r*x)/(x-1); }
  const el={
    total:$('#in-total'), addl:$('#in-addl'),
    milBtn:$('#btn-mil'), milPanel:$('#mil-panel'), milBreak:$('#mil-breakdown'),
    rankSel:$('#sel-rank'), yearsSel:$('#sel-years'), depSel:$('#sel-deps'), zipSel:$('#sel-zip'),
    exCore:$('#ex-core'), exDisc:$('#ex-disc'),
    bpBtn:$('#btn-bp'), bpPanel:$('#bp-panel'),
    saveRate:$('#save-rate'),
    cs:$('#cs-slider'), csLabel:$('#cs-label'), aprLabel:$('#apr-label'),
    hPrice:$('#h-price'), dpSlider:$('#dp-slider'), dpPctLabel:$('#dp-pct-label'),
    dpAmtLabel:$('#dp-amt-label'), dpAmt:$('#dp-amt'),
    hRate:$('#h-rate'), hTerm:$('#h-term'), hTIHOA:$('#h-tihoa'), hPMI:$('#h-pmi'),
    btnCalc:$('#btn-calc'), btnClear:$('#btn-clear'),
    kIncome:$('#kpi-income'), kExp:$('#kpi-expenses'), kMortgage:$('#kpi-mortgage'),
    kSave:$('#kpi-savings'), kDisp:$('#kpi-disposable'),
    pie:$('#pie'), bars:$('#bars'),
    statusBox:$('#statusBox'), statusDot:$('#statusDot'), statusTitle:$('#statusTitle'),
    statusMsg:$('#statusMsg'), meterFill:$('#meterFill'),
    fidText:$('#fiduciaryText'),
    bpLoad:$('#bp-load'),
    milUpdate:$('#btn-mil-update'),
  };
  // Military tables
  const BAS_TABLE={enlisted:465.77, officer:320.78};
  const BASEPAY={
    "E-1":{a2:2319},"E-2":{a2:2599},"E-3":{a2:2733,o2:2905,o3:3081},
    "E-4":{a2:3027,o2:3182,o3:3355,o4:3525,o6:3676},
    "E-5":{a2:3221,o2:3467,o3:3638,o4:3802,o6:3959,o8:4142,o10:4235,o12:4260},
    "E-6":{a2:3277,o2:3606,o3:3765,o4:3920,o6:4081,o8:4444,o10:4585,o12:4859},
    "E-7":{a2:3788,o2:4134,o3:4293,o4:4502,o6:4667,o8:4948,o10:5106,o12:5387,o14:5621,o16:5781,o18:5951},
    "E-8":{o8:5450,o10:5691,o12:5840,o14:6019,o16:6212,o18:6562,o20:6740,o22:7041,o24:7208},
    "E-9":{o10:6657,o12:6808,o14:6998,o16:7222,o18:7448,o20:7808,o22:8115,o24:8436},
    "O-1":{a2:3998,o2:4162,o3:5031},
    "O-2":{a2:4607,o2:5247,o3:6043,o4:6247,o6:6375},
    "O-3":{a2:5332,o2:6044,o3:6523,o4:7112,o6:7454,o8:7828,o10:8069},
    "O-4":{a2:6064,o2:7020,o3:7489,o4:7592,o6:8027,o8:8494,o10:9075,o12:9526},
    "O-5":{a2:7028,o2:7917,o3:8465,o4:8569,o6:8911,o8:9115,o10:9565,o12:9896,o14:10323,o16:10974},
    "O-6":{a2:8431,o2:9262,o3:9870,o6:9908,o8:10332,o10:10389,o14:10979,o16:12023,o18:12635}
  };
  const BAH_SATX={with:{E1:1791,E2:1791,E3:1791,E4:1791,E5:1935,E6:2154,E7:2172,E8:2181,E9:2208,O1:1968,O2:2151,O3:2187,O4:2340,O5:2466,O6:2487},
                  without:{E1:1344,E2:1344,E3:1344,E4:1344,E5:1530,E6:1656,E7:1794,E8:1983,E9:2037,O1:1644,O2:1890,O3:2070,O4:2148,O5:2160,O6:2163}};
  const tiersOrder=['a2','o2','o3','o4','o6','o8','o10','o12','o14','o16','o18','o20','o22','o24'];
  const yosMil=(y)=> y<=2?'a2': y<=3?'o2': y<=4?'o3': y<=6?'o4': y<=8?'o6': y<=10?'o8': y<=12?'o10': y<=14?'o12': y<=16?'o14': y<=18?'o16': y<=20?'o18': y<=22?'o20': y<=24?'o22':'o24';
  function basePayNearest(rank, years){
    const table=BASEPAY[rank]||{}; const desired=yosMil(Number(years)||2);
    let i=tiersOrder.indexOf(desired); if(i<0) i=tiersOrder.length-1;
    for(let k=i;k>=0;k--){ const key=tiersOrder[k]; if(table[key]!=null) return table[key]; }
    const keys=Object.keys(table); return keys.length? table[keys[0]] : 0;
  }
  const basByRank=(r)=> (r||'').startsWith('O-')?BAS_TABLE.officer:BAS_TABLE.enlisted;
  const bahSATX=(r,d)=> BAH_SATX[d]?.[(r||'').replace('-','')]||0;
  function scoreAPRLocal(score){
    const s=Number(score)||720;
    if(s>=780) return 6.50; if(s>=760) return 6.75; if(s>=720) return 7.00;
    if(s>=700) return 7.20; if(s>=680) return 7.35; if(s>=660) return 7.85;
    if(s>=640) return 8.25; if(s>=620) return 9.25; return 9.95;
  }
  let pieChart=null, barChart=null;
  function initCharts(){
    // destroy if re-rendered for any reason
    if (pieChart){ pieChart.destroy(); pieChart=null; }
    if (barChart){ barChart.destroy(); barChart=null; }
    pieChart = new Chart(el.pie.getContext('2d'), {
      type:'doughnut',
      data:{ labels:['Expenses','Savings','Housing','Disposable'], datasets:[{ data:[0,0,0,1], backgroundColor:['#6aa7ff','#8ef3c5','#f9c74f','#55d399'] }] },
      options:{ plugins:{ legend:{ labels:{ color:'#cfd5ff' } } }, cutout:'62%', responsive:true, maintainAspectRatio:false }
    });
    barChart = new Chart(el.bars.getContext('2d'), {
      type:'bar',
      data:{ labels:['Income','Expenses','Savings','Housing','Disposable'], datasets:[{ label:'Monthly $', data:[0,0,0,0,0], backgroundColor:['#55d399','#6aa7ff','#8ef3c5','#f9c74f','#9bd8c0'] }] },
      options:{
        plugins:{ legend:{ labels:{ color:'#cfd5ff' } },
          tooltip:{ callbacks:{ label(ctx){
            const i=ctx.dataIndex;
            if(i===0){return ['Income Breakdown:','Base Pay: '+fmt(milState.base),'BAS: '+fmt(milState.bas),'BAH: '+fmt(milState.bah),'Additional: '+fmt(Number(el.addl.value)||0)];}
            if(i===1){return ['Expenses Breakdown:','Essentials+Debt+Other: '+fmt(Number(el.exCore.value)||0),'Discretionary: '+fmt(Number(el.exDisc.value)||0)];}
            if(i===3){const s=compute(); return ['Housing Breakdown:','Principal & Interest: '+fmt(s.pAndI),'Taxes/Ins/HOA: '+fmt(Number(el.hTIHOA.value)||0),'PMI: '+fmt(Number(el.hPMI.value)||0)];}
            return 'Monthly $: '+fmt(ctx.raw);
          }}} },
        scales:{ x:{ ticks:{ color:'#cfd5ff' } }, y:{ ticks:{ color:'#cfd5ff' } } },
        responsive:true, maintainAspectRatio:false
      }
    });
  }
  // Itemized budget store
  let BP_ROWS=[], BP_ID=1;
  function bpTotals(){ const t={Essentials:0,Discretionary:0,Debt:0,Other:0}; BP_ROWS.forEach(r=> t[r.cat]+=Number(r.month)||0); t.All=t.Essentials+t.Discretionary+t.Debt+t.Other; return t; }
  function bpTotalsUI(){ const t=bpTotals(); $('#bp-t-Essentials').textContent=fmt(t.Essentials); $('#bp-t-Discretionary').textContent=fmt(t.Discretionary); $('#bp-t-Debt').textContent=fmt(t.Debt); $('#bp-t-Other').textContent=fmt(t.Other); $('#bp-t-All').textContent=fmt(t.All); }
  function bpRender(){
    const tb=$('#bp-body'); if(!tb) return; tb.innerHTML='';
    BP_ROWS.forEach(r=>{
      const tr=document.createElement('tr'); tr.className='bp-tr';
      tr.innerHTML=`<td class="bp-td"><select class="va-select bp-cat" data-id="${r.id}">
          <option ${r.cat==='Essentials'?'selected':''}>Essentials</option>
          <option ${r.cat==='Discretionary'?'selected':''}>Discretionary</option>
          <option ${r.cat==='Debt'?'selected':''}>Debt</option>
          <option ${r.cat==='Other'?'selected':''}>Other</option>
        </select></td>
        <td class="bp-td"><input class="va-input bp-name" data-id="${r.id}" value="${r.name||''}"></td>
        <td class="bp-td" style="width:140px"><input class="va-input bp-month" data-id="${r.id}" type="number" min="0" step="1" value="${r.month||0}"></td>
        <td class="bp-td" style="width:120px">${fmt((r.month||0)*12)}</td>
        <td class="bp-td" style="width:80px"><button class="va-btn ghost bp-del" data-id="${r.id}">✕</button></td>`;
      tb.appendChild(tr);
    });
    $$('.bp-cat').forEach(x=>x.addEventListener('change',e=>{ const rr=BP_ROWS.find(z=>z.id==e.target.dataset.id); if(rr){rr.cat=e.target.value; bpTotalsUI();}}));
    $$('.bp-name').forEach(x=>x.addEventListener('input',e=>{ const rr=BP_ROWS.find(z=>z.id==e.target.dataset.id); if(rr) rr.name=e.target.value; }));
    $$('.bp-month').forEach(x=>x.addEventListener('input',e=>{ const rr=BP_ROWS.find(z=>z.id==e.target.dataset.id); if(rr){rr.month=Number(e.target.value)||0; bpTotalsUI();}}));
    $$('.bp-del').forEach(x=>x.addEventListener('click',e=>{ BP_ROWS=BP_ROWS.filter(r=>r.id!==Number(e.target.dataset.id)); bpRender(); }));
    bpTotalsUI();
  }
  $('#bp-add')?.addEventListener('click', ()=>{
    const cat=$('#bp-cat').value; const name=$('#bp-name').value.trim()||'Item'; const m=Number($('#bp-month').value)||0;
    BP_ROWS.push({id:BP_ID++,cat,name,month:m}); $('#bp-name').value=''; $('#bp-month').value=''; bpRender();
  });
  $('#bp-save')?.addEventListener('click', ()=>{
    const t=bpTotals(); const core=t.Essentials+t.Debt+t.Other; const disc=t.Discretionary;
    localStorage.setItem('va.expenses.core', String(Math.round(core)));
    localStorage.setItem('va.expenses.disc', String(Math.round(disc)));
    localStorage.setItem('va.expenses.rows', JSON.stringify(BP_ROWS));
    $('#bp-note').textContent='Saved! Totals copied above.';
    el.exCore.value=Math.round(core); el.exDisc.value=Math.round(disc); render();
  });
  $('#bp-load')?.addEventListener('click', ()=>{
    BP_ROWS=[{id:1,cat:'Essentials',name:'Rent',month:1200},{id:2,cat:'Essentials',name:'Utilities',month:250},{id:3,cat:'Essentials',name:'Insurance',month:300},{id:4,cat:'Essentials',name:'Car Payment',month:400},{id:5,cat:'Discretionary',name:'Food & Dining',month:600},{id:6,cat:'Discretionary',name:'Entertainment',month:200},{id:7,cat:'Debt',name:'Credit Cards',month:300}];
    BP_ID=8; bpRender();
    const t=bpTotals(); const core=t.Essentials+t.Debt+t.Other; const disc=t.Discretionary;
    el.exCore.value=Math.round(core); el.exDisc.value=Math.round(disc); render();
    $('#bp-note').textContent='Example loaded. Edit amounts, then Save & Prefill to store.';
  });
  (function bpRestore(){ try{
    const raw=localStorage.getItem('va.expenses.rows'); if(raw){ BP_ROWS=JSON.parse(raw)||[]; BP_ID=BP_ROWS.reduce((m,r)=>Math.max(m,r.id||0),0)+1; bpRender(); }
    const core=+localStorage.getItem('va.expenses.core')||0; const disc=+localStorage.getItem('va.expenses.disc')||0;
    if(core||disc){ el.exCore.value=core; el.exDisc.value=disc; }
  }catch(e){} })();
  const milState={active:false,rank:'E-6',years:10,deps:'with',zip:'78236',base:0,bas:0,bah:0};
  function updateMilitaryIncome(){
    milState.active=true;
    milState.rank=el.rankSel.value||'E-6';
    milState.years=Number(el.yearsSel.value||10);
    milState.deps=el.depSel.value||'with';
    milState.zip=el.zipSel.value||'78236';
    const base=basePayNearest(milState.rank,milState.years);
    const bas=basByRank(milState.rank);
    const bah=milState.zip==='78236'? bahSATX(milState.rank,milState.deps):0;
    milState.base=base; milState.bas=bas; milState.bah=bah;
    const total=Math.round(base+bas+bah);
    el.total.value=String(total);
    el.milBreak.textContent=`Est. Base ${fmt(base)} + BAS ${fmt(bas)} + BAH ${fmt(bah)} ${milState.zip!=='78236'?'(ZIP not SATX — BAH $0)':''} → Total ${fmt(total)}.`;
    render();
  }
  function readNum(i){ return Number.parseFloat((i&&i.value)||'0')||0; }
  function compute(){
    const income = readNum(el.total) + readNum(el.addl);
    const expenses = readNum(el.exCore) + readNum(el.exDisc);
    const saveRate=(Number(el.saveRate.value)||0)/100;
    const savings = Math.max(0, income * saveRate);
    const inferredAPR = scoreAPRLocal(el.cs.value);
    const usedAPR = Number(el.hRate.value)||inferredAPR;
    const price = readNum(el.hPrice);
    const dpPct = (Number(el.dpSlider.value)||0)/100;
    const downAmount = Math.max(0, price * dpPct);
    const loan = Math.max(0, price - downAmount);
    const mRate = (usedAPR||0)/100/12;
    const nMonths = Math.max(1, (Number(el.hTerm.value)||30)*12);
    const pAndI = loan>0 ? pmti(loan, mRate, nMonths) : 0;
    const tihoa = readNum(el.hTIHOA);
    const pmi = readNum(el.hPMI);
    const housing = pAndI + tihoa + pmi;
    const freePre  = income - expenses - savings;
    const freePost = income - expenses - savings - housing;
    const housingShare = income>0 ? housing/income : 0;
    const totalShare   = income>0 ? (expenses + savings + housing)/income : 0;
    const dti          = income>0 ? (expenses + housing)/income : 0;
    return {income,expenses,savings,freePre,freePost,housing,housingShare,totalShare,dti,loan,pAndI,dpPct,downAmount,inferredAPR,usedAPR};
  }
  function render(){
    const s=compute();
    el.kIncome.textContent=fmt(s.income);
    el.kExp.textContent=fmt(s.expenses);
    el.kSave.textContent=fmt(s.savings);
    el.kMortgage.textContent=fmt(s.housing);
    el.kDisp.textContent = s.freePost>=0 ? fmt(s.freePost) : ('-'+fmt(Math.abs(s.freePost)));
    const shareAfter = s.income>0 ? (s.freePost/s.income) : 0;
    let cls='neutral'; if (s.freePost<0) cls='bad'; else if (shareAfter>=.2) cls='good'; else if (shareAfter>=.1) cls='warn';
    el.kDisp.className=''; el.kDisp.classList.add(cls);
    // charts
    if(!pieChart || !barChart) initCharts();
    pieChart.data.datasets[0].data=[s.expenses,s.savings,s.housing,Math.max(0,s.freePost)];
    pieChart.update();
    barChart.data.datasets[0].data=[s.income,s.expenses,s.savings,s.housing,s.freePost];
    barChart.update();
    // meter + status
    el.meterFill.style.width=(clamp01(s.totalShare)*100).toFixed(0)+'%';
    let title='Healthy Plan', msg='You remain cash-flow positive after expenses, savings, and proposed housing.', cls2='ok', dot='var(--ok)';
    if (s.totalShare>=0.85 || s.freePost<0){ title='Risky: Overcommitted'; msg='Plan likely overextends cash flow. Reduce house price/rate/expenses.'; cls2='bad'; dot='var(--danger)'; }
    else if (s.totalShare>=0.70){ title='Caution Zone'; msg='Budget is tight. Aim for ≥15% buffer after all costs.'; cls2='warn'; dot='var(--warning)'; }
    el.statusBox.classList.remove('ok','warn','bad'); el.statusBox.classList.add(cls2);
    el.statusTitle.textContent=title; el.statusMsg.textContent=msg; el.statusDot.style.background=dot;
    // labels
    const score=Number(el.cs.value)||720;
    const band=score>=760?'Excellent':score>=720?'Good':score>=680?'Fair':score>=640?'OK-ish':score>=620?'Weak':'Subprime';
    el.csLabel.textContent=`${score} – ${band}`;
    el.aprLabel.textContent=(s.inferredAPR||0).toFixed(2)+'%';
    el.dpPctLabel.textContent=(s.dpPct*100).toFixed(0)+'%';
    el.dpAmtLabel.textContent=fmt(s.downAmount);
    el.dpAmt.value=fmt(s.downAmount);
    // guidance snippets
    const bullets=[];
    if (milState.active){
      bullets.push(`Military est. used — ${milState.rank}, ${milState.years} yrs, ${milState.deps==='with'?'with deps':'no deps'}, ZIP ${milState.zip}. Base ${fmt(milState.base)}, BAS ${fmt(milState.bas)}, BAH ${fmt(milState.bah)}.`);
    } else bullets.push('Tip: Use Military Pay to auto-fill Base + BAS + BAH (San Antonio only).');
    if (s.loan>0){
      bullets.push(`P&I ≈ ${fmt(s.pAndI)}; all-in housing ≈ ${fmt(s.housing)} (${(s.housingShare*100).toFixed(1)}% of income).`);
      bullets.push(`Loan amount ≈ ${fmt(s.loan)} with ${el.hTerm.value} yrs @ ${Number(el.hRate.value).toFixed(2)}% APR.`);
    } else bullets.push('Set a home price to evaluate a proposed monthly payment.');
    bullets.push(`Disposable after house: ${s.freePost>=0?fmt(s.freePost):('-'+fmt(Math.abs(s.freePost)))}.`);
    bullets.push(`Total committed share: ${(s.totalShare*100).toFixed(0)}%. Rough DTI: ${(s.dti*100).toFixed(0)}%.`);
    el.fidText.innerHTML='<ul style="margin:8px 0 0 18px">'+bullets.map(b=>`<li style="margin:6px 0">${b}</li>`).join('')+'</ul>';
  }
  function wire(){
    // populate military selects
    (function populate(){
      const ranks=['E-1','E-2','E-3','E-4','E-5','E-6','E-7','E-8','E-9','O-1','O-2','O-3','O-4','O-5','O-6'];
      if(el.rankSel) el.rankSel.innerHTML=ranks.map(r=>`<option value="${r}">${r}</option>`).join('');
      if(el.yearsSel){ let y=''; for(let i=2;i<=24;i++) y+=`<option value="${i}">${i}</option>`; el.yearsSel.innerHTML=y; }
      if(el.rankSel) el.rankSel.value='E-6'; if(el.yearsSel) el.yearsSel.value='10';
    })();
    // toggles
    el.milBtn.addEventListener('click', ()=>{
      el.milPanel.classList.toggle('hidden');
      el.milBtn.textContent = el.milPanel.classList.contains('hidden') ? '▼ Military Pay (optional)' : '▲ Military Pay (hide)';
    });
    el.bpBtn.addEventListener('click', ()=>{
      el.bpPanel.classList.toggle('hidden');
      el.bpBtn.textContent = el.bpPanel.classList.contains('hidden') ? '▼ Itemized Monthly Budget (open here)' : '▲ Itemized Monthly Budget (hide)';
    });
    // show estimate on selector change; commit only on explicit update
    [el.rankSel,el.yearsSel,el.depSel,el.zipSel].forEach(s=> s && s.addEventListener('change', ()=>{
      const rank=el.rankSel.value||'E-6', years=Number(el.yearsSel.value||10), deps=el.depSel.value||'with', zip=el.zipSel.value||'78236';
      const b=basePayNearest(rank,years), a=basByRank(rank), h=zip==='78236'? bahSATX(rank,deps):0;
      el.milBreak.textContent=`Est. Base ${fmt(b)} + BAS ${fmt(a)} + BAH ${fmt(h)} ${zip!=='78236'?'(ZIP not SATX — BAH $0)':''} → Total ${fmt(Math.round(b+a+h))}.`;
    }));
    el.milUpdate?.addEventListener('click', updateMilitaryIncome);
    // inputs re-render
    [el.total,el.addl,el.exCore,el.exDisc,el.hPrice,el.hRate,el.hTerm,el.hTIHOA,el.hPMI].forEach(i=> i && i.addEventListener('input', render));
    el.saveRate.addEventListener('input', ()=>{ $('#save-rate-label').textContent=el.saveRate.value+'%'; render(); });
    el.cs.addEventListener('input', ()=>{ if(!el.hRate.dataset.touched){ el.hRate.value = scoreAPRLocal(el.cs.value).toFixed(2); } render(); });
    el.hRate.addEventListener('input', ()=>{ el.hRate.dataset.touched='1'; render(); });
    const updDP=()=>{ const s=compute(); el.dpPctLabel.textContent=(s.dpPct*100).toFixed(0)+'%'; el.dpAmtLabel.textContent=fmt(s.downAmount); el.dpAmt.value=fmt(s.downAmount); };
    el.dpSlider.addEventListener('input', ()=>{ updDP(); render(); });
    el.hPrice.addEventListener('input', ()=>{ updDP(); render(); });
    // buttons
    el.btnCalc.addEventListener('click', render);
    el.btnClear.addEventListener('click', ()=>{
      $$('input').forEach(inp=>{ if(inp.type==='range') return; if(!inp.disabled) inp.value=''; });
      el.saveRate.value=15; $('#save-rate-label').textContent='15%';
      el.cs.value=720; el.hRate.value=scoreAPRLocal(720).toFixed(2);
      el.dpSlider.value=20; el.milBreak.textContent='—'; render();
    });
    // charts once
    initCharts();
    // first paint
    render();
  }
  // Initialize when DOM is ready
  if (document.readyState==='loading') {
    document.addEventListener('DOMContentLoaded', wire, {once:true});
  } else { wire(); }
})();
</script>
              </div>
            </div>
            <div class="hp-hero-btn-wrap">
              <div class="hp_button_box">
                <div class="hp_button_background"></div>
                <div class="d-none w-embed">
                  <style>
.hp_button_background{
  background: linear-gradient(var(--gradient-angle), var(--g_color_02), var(--g_color_01));
}
.hp_button_box:hover .hp_button_background{
  animation: rotation 5s linear infinite;
}
@keyframes rotation {
  0% {
  	--gradient-angle : 0deg;
  }
  100% {
     --gradient-angle : 360deg;
  }
}
@property --gradient-angle
{
    syntax: "<angle>";
    initial-value: 0deg;
    inherits: false;
}
</style>
                </div>
              </div>
              <div class="hp_button_box">
                <div class="hp_button_background"></div>
                <div class="d-none w-embed">
                  <style>
.hp_button_background{
  background: linear-gradient(var(--gradient-angle), var(--g_color_02), var(--g_color_01));
}
.hp_button.hp-hero-btn.hp-hero-btn-two:hover{
	background-color: transparent;
  color: #FBF8F8;
}
.hp_button_box:hover .hp_button_background{
  animation: rotation 5s linear infinite;
}
@keyframes rotation {
  0% {
  	--gradient-angle : 0deg;
  }
  100% {
     --gradient-angle : 360deg;
  }
}
@property --gradient-angle
{
    syntax: "<angle>";
    initial-value: 0deg;
    inherits: false;
}
</style>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <section>
        <section>
          <div class="hp_inner_banner_wrapper">
            <div class="container-4">
              <div data-w-id="22b64494-3905-5703-c8f6-dd88fc9e09d6" style="-webkit-transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(null, 60%, 0) scale3d(0.9, 0.9, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);opacity:0" class="hp_hero_banner_content_box-2">
                <h1 class="hp_hero_banner_title">Comprehensive A.I <br>Financial Analysis </h1>
                <p class="hp_title_dis hp_hero_banner_trust_content_dis">Comprehensive Budget, Credit Score, and Purchase Analysis to ensure your Financial Health is in Order. </p>
                <div class="hero-title-wrapper-2 full">
                  <div data-w-id="30ba1858-c2e3-e2a7-a85c-7e79fd4be799" class="slide-animation-wrapper">
                    <div class="text-overflow-hidden-2">
                      <div class="shadow-2 second"></div>
                    </div>
                  </div>
                  <div data-w-id="30ba1858-c2e3-e2a7-a85c-7e79fd4be79c" class="slide-animation-wrapper">
                    <div class="text-overflow-hidden-2">
                      <div class="shadow-2 third"></div>
                    </div>
                  </div>
                  <div data-w-id="30ba1858-c2e3-e2a7-a85c-7e79fd4be79f" style="opacity:0" class="buttons-row">
                    <a href="#" data-w-id="30ba1858-c2e3-e2a7-a85c-7e79fd4be7a0" class="primary-glow-wrapper-2 w-inline-block">
                      <div data-w-id="30ba1858-c2e3-e2a7-a85c-7e79fd4be7a1" class="button-overflow-hidden mobile-full-width">
                        <div class="box-shadow-block-4">
                          <div class="pedding-stroke-4"></div>
                          <div style="opacity:0.6" class="glow-wrapper stroke">
                            <div class="glow-item left second-version"></div>
                            <div class="glow-item second-version"></div>
                          </div>
                        </div>
                      </div>
                    </a>
                    <a href="#" data-w-id="30ba1858-c2e3-e2a7-a85c-7e79fd4be7a7" class="primary-glow-wrapper-2 w-inline-block">
                      <div data-w-id="30ba1858-c2e3-e2a7-a85c-7e79fd4be7a8" class="button-overflow-hidden mobile-full-width">
                        <div class="box-shadow-block-4">
                          <div class="pedding-stroke-4">
                            <div class="inside-button-3">
                              <div class="button-text-6">Get Activation Code</div>
                              <div style="-webkit-transform:translate3d(-100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(-100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(-100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(-100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)" class="hover-line-4"></div>
                            </div>
                          </div>
                          <div style="opacity:0.6" class="glow-wrapper stroke">
                            <div class="glow-item left"></div>
                            <div class="glow-item"></div>
                          </div>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
                <div class="hp_button_box">
                  <div class="hp_button_background"></div>
                  <div class="d-none w-embed">
                    <style>
.hp_button_background{
  background: linear-gradient(var(--gradient-angle), var(--g_color_02), var(--g_color_01));
}
.hp_button_box:hover .hp_button_background{
  animation: rotation 5s linear infinite;
}
@keyframes rotation {
  0% {
  	--gradient-angle : 0deg;
  }
  100% {
     --gradient-angle : 360deg;
  }
}
@property --gradient-angle
{
    syntax: "<angle>";
    initial-value: 0deg;
    inherits: false;
}
</style>
                  </div>
                </div>
                <section>
                  <div class="code-embed-5 w-embed w-script"><!--  Fiduciary Snapshot (key-gated, responsive charts, Elena guidance)  -->
                    <div id="fid-snapshot" style="all: initial;">
                      <style>
    #fid-snapshot, #fid-snapshot *{ box-sizing:border-box; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
    #fid-snapshot .wrap{ max-width:1120px; margin:18px auto 56px; padding:0 16px; color:#e9ecff; }
    #fid-snapshot .card{ background:#181b2e; border:1px solid rgba(255,255,255,.08); border-radius:18px; box-shadow:0 10px 24px rgba(0,0,0,.35); padding:18px; position:relative; }
    /* Frosted overlay */
    #fid-snapshot .frost{ position:absolute; inset:0; border-radius:16px; background:rgba(15,18,32,0.48);
      backdrop-filter:blur(6px) saturate(1.08); -webkit-backdrop-filter:blur(6px) saturate(1.08);
      border:1px solid rgba(255,255,255,0.08); display:grid; place-items:center; opacity:1; pointer-events:auto; transition:opacity .25s; }
    #fid-snapshot.unlocked .frost{ opacity:0; pointer-events:none; }
    /* key row */
    #fid-snapshot .row{ display:grid; grid-template-columns:1fr auto; gap:12px; align-items:center; }
    @media (max-width:720px){ #fid-snapshot .row{ grid-template-columns:1fr; } }
    #fid-snapshot .kbox{ background:#0f1220; border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:12px; }
    #fid-snapshot .kbox label{ display:block; color:#a8b0d6; font-size:12px; margin-bottom:6px; }
    #fid-snapshot .input{ width:100%; background:#0b1022; border:1px solid rgba(255,255,255,.12); color:#e9ecff; border-radius:12px; padding:12px; font-size:14px; outline:none; }
    #fid-snapshot .badge{ display:inline-flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.08); background:#0f1326; }
    #fid-snapshot .dot{ width:10px; height:10px; border-radius:50%; }
    /* charts grid */
    #fid-snapshot .charts{ display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:12px; }
    @media (max-width:900px){ #fid-snapshot .charts{ grid-template-columns:1fr; } }
    #fid-snapshot .card-mini{ background:#12162b; border:1px solid rgba(255,255,255,.06); border-radius:16px; padding:12px; min-height:220px; display:flex; flex-direction:column; }
    #fid-snapshot .card-mini h3{ margin:0 0 8px; font-size:14px; color:#cfd5ff; font-weight:600; }
    /* responsive canvas container: grows with card; clamp keeps it elegant */
    #fid-snapshot .chart-holder{
      position:relative;
      height: clamp(180px, 34vh, 360px);
      width: 100%;
      display:block;
      overflow: hidden;
      border-radius:12px;
    }
    #fid-snapshot canvas{
      width:100% !important;
      height:100% !important;
      display:block;
    }
    /* KPIs */
    #fid-snapshot .kpi{ display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:12px; margin-top:12px; }
    @media (max-width:900px){ #fid-snapshot .kpi{ grid-template-columns:1fr; } }
    #fid-snapshot .k{ background:#0f1220; border:1px solid rgba(255,255,255,.06); border-radius:12px; padding:12px; }
    #fid-snapshot .k small{ color:#a8b0d6; font-size:11px; }
    #fid-snapshot .k b{ display:block; margin-top:6px; font-size:16px; }
    #fid-snapshot b.good{ color:#55d399 } b.warn{ color:#f9c74f } b.bad{ color:#ff6b6b } b.neutral{ color:#cfd5ff }
    /* sections */
    #fid-snapshot .blk{ background:#12162b; border:1px solid rgba(255,255,255,.06); border-radius:16px; padding:16px; margin-top:12px; position:relative; }
    #fid-snapshot .blk h3{ margin:0 0 6px; font-size:16px; }
    #fid-snapshot .note{ color:#a8b0d6; font-size:12px; }
    #fid-snapshot .muted{ color:#a8b0d6; font-size:11px; }
    /* lock chip */
    #fid-snapshot .chip{ display:inline-flex; align-items:center; gap:8px; padding:8px 10px; background:#0f1326; border:1px solid rgba(255,255,255,.08); border-radius:999px; font-size:12px; color:#cfd5ff; }
  </style>
                      <div class="wrap">
                        <div class="card" id="fid-card">
                          <div class="row">
                            <div class="kbox">
                              <label>ENTER ACTIVATION KEY</label>
                              <input id="fid-key" class="input" placeholder="e.g., 9563379087">
                              <div class="muted">Enter the code provided by your advisor to unlock analysis. (Hint: 956-337-9087)</div>
                            </div>
                            <span class="badge"><span id="fid-dot" class="dot" style="background:#888"></span><b id="fid-grade">Locked</b></span>
                          </div>
                          <div class="charts">
                            <div class="card-mini">
                              <h3>Visual Budget</h3>
                              <div class="chart-holder">
                                <canvas id="fid-pie"></canvas>
                                <div class="frost"><span class="chip">🔒 Locked</span></div>
                              </div>
                              <div class="muted" style="margin-top:6px">Income allocation: Expenses, Savings, Housing, Disposable.</div>
                            </div>
                            <div class="card-mini">
                              <h3>Itemized Monthly Budget</h3>
                              <div class="chart-holder">
                                <canvas id="fid-bars"></canvas>
                                <div class="frost"><span class="chip">🔒 Locked</span></div>
                              </div>
                              <div class="muted" style="margin-top:6px">Top items from your saved budget (Planner) — often grouped.</div>
                            </div>
                          </div>
                          <div class="kpi">
                            <div class="k"><small>Disposable After Housing</small><b id="k-after" class="neutral">$0</b></div>
                            <div class="k"><small>Housing Share of Income</small><b id="k-hshare">0%</b></div>
                            <div class="k"><small>Total Committed Share</small><b id="k-tshare">0%</b></div>
                          </div>
                          <div class="kpi" style="grid-template-columns:repeat(3,minmax(0,1fr))">
                            <div class="k"><small>DTI (rough)</small><b id="k-dti">0%</b></div>
                            <div class="k"><small>LTV</small><b id="k-ltv">0%</b></div>
                            <div class="k"><small>Credit Score → APR</small><b id="k-score">720 → 7.00%</b></div>
                          </div>
                          <div class="blk">
                            <h3>Fiduciary Guidance</h3>
                            <div id="fid-guidance" class="note">Enter key to unlock.</div>
                            <div class="frost"><span class="chip">🔒 Locked</span></div>
                          </div>
                          <div class="blk">
                            <h3>Assumptions & Notes</h3>
                            <div id="fid-assump" class="note">Enter key to unlock.</div>
                            <div class="frost"><span class="chip">🔒 Locked</span></div>
                          </div>
                          <div class="muted" style="margin-top:10px">Outputs are educational, not advice.</div>
                        </div>
                      </div>
                      <!--  Chart.js  -->
                      <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
                      <script>
  (()=> {
    if (window.__FIDUCIARY_WIDGET_MOUNTED__) return;
    window.__FIDUCIARY_WIDGET_MOUNTED__ = true;
    const UNLOCK_KEY_NUM = "9563379087";
    /* ---------- utils ---------- */
    const $=(q)=>document.querySelector(q);
    const onlyDigits=(s)=> String(s||'').replace(/\D+/g,'');
    const cur=(n,d=0)=> (Number(n)||0).toLocaleString('en-US',{style:'currency',currency:'USD',minimumFractionDigits:d,maximumFractionDigits:d});
    const pct=(x,d=0)=> ((Number(x)||0)*100).toFixed(d)+'%';
    const read=(id)=> Number.parseFloat((document.getElementById(id)?.value||'0'))||0;
    const clean=(t)=> (t||'').replace(/\s+/g,' ').trim();
    const looksMoney=(t)=> /^\s*(\$|£|€)?\s*\d[\d,]*(\.\d+)?\s*$/.test(t||'');
    function pmti(P,r,n){ if(r===0) return P/n; const x=Math.pow(1+r,n); return P*(r*x)/(x-1); }
    function scoreAPR(s){ s=Number(s)||720;
      if(s>=780) return 6.50; if(s>=760) return 6.75; if(s>=720) return 7.00; if(s>=700) return 7.20;
      if(s>=680) return 7.35; if(s>=660) return 7.85; if(s>=640) return 8.25; if(s>=620) return 9.25; return 9.95; }
    /* ---------- snapshot ---------- */
    function snapshot(){
      const income   = read('in-total') + read('in-addl');
      const expenses = read('ex-core') + read('ex-disc');
      const saveRate = (Number(document.getElementById('save-rate')?.value)||0)/100;
      const savings  = Math.max(0, income * saveRate);
      const price = read('h-price');
      const dpPct = (Number(document.getElementById('dp-slider')?.value)||0)/100;
      const dpAmt = Math.max(0, price * dpPct);
      const loan  = Math.max(0, price - dpAmt);
      const score = Number(document.getElementById('cs-slider')?.value)||720;
      const inferredAPR = scoreAPR(score);
      const apr = Number(document.getElementById('h-rate')?.value)||inferredAPR;
      const termY = Number(document.getElementById('h-term')?.value)||30;
      const mRate = (apr||0)/100/12;
      const pAndI = loan>0 ? pmti(loan, mRate, termY*12) : 0;
      const tihoa = read('h-tihoa');
      const pmi   = read('h-pmi');
      const housing = pAndI + tihoa + pmi;
      const freePre  = income - expenses - savings;
      const freePost = income - expenses - savings - housing;
      const housingShare = income>0 ? housing/income : 0;
      const totalShare   = income>0 ? (expenses + savings + housing)/income : 0;
      const dti          = income>0 ? (expenses + housing)/income : 0;
      const ltv          = price>0 ? (loan/price) : 0;
      return {income,expenses,savings,freePre,freePost,housing,housingShare,totalShare,dti,price,dpPct,dpAmt,loan,score,apr,inferredAPR,termY,ltv,tihoa,pmi,pAndI};
    }
    /* ---------- planner section (outside widget) ---------- */
    function findPlannerSection(){
      const root = document.getElementById('fid-snapshot');
      const nodes = Array.from(document.querySelectorAll('h1,h2,h3,h4,summary,button,div,span'))
        .filter(n=>{
          const t = clean(n.textContent).toLowerCase();
          return t && t.includes('itemized monthly budget') && !root.contains(n);
        });
      for(const n of nodes){ if(n.offsetParent!==null) return n.closest('section,fieldset,form,div') || n.parentElement; }
      return null;
    }
    /* ---------- read rows ---------- */
    const BAD_LABEL = /^(category|item|monthly|annual|del|delete|essentials|discretionary|debt|other)$/i;
    function valueFrom(el){
      if(!el) return 0; const raw = (el.value ?? el.textContent ?? '').toString();
      return Number(raw.replace(/[^0-9.-]/g,'')) || 0;
    }
    function extractNameFromRow(row){
      if(!row) return 'Item';
      const txt = row.querySelector('input[type="text"], textarea, [contenteditable="true"]');
      if(txt){
        const v = clean(txt.value || txt.textContent || txt.getAttribute('value') || txt.getAttribute('placeholder'));
        if(v && !BAD_LABEL.test(v) && !looksMoney(v)) return v;
      }
      const leafs = Array.from(row.querySelectorAll('*')).filter(n=>n.children.length===0);
      for(const n of leafs){
        const t=clean(n.textContent);
        if(t && t.length<=48 && !BAD_LABEL.test(t) && !looksMoney(t)) return t;
      }
      return 'Item';
    }
    function getItemizedFromDOM(){
      const section = findPlannerSection();
      if(!section) return [];
      const table = section.querySelector('table');
      if(table){
        const out=[], rows = Array.from(table.querySelectorAll('tbody tr')).filter(r=>r.offsetParent!==null);
        for(const tr of rows){
          const monthCell = tr.querySelector('td:nth-child(3), td[aria-label*="monthly" i]') || tr;
          const month = valueFrom(monthCell.querySelector('input, [contenteditable="true"]')) || valueFrom(monthCell);
          if(month<=0) continue;
          const itemCell = tr.querySelector('td:nth-child(2), td.item, td[aria-label*="item" i]') || tr;
          out.push({ name: extractNameFromRow(itemCell), month });
        }
        if(out.length) return out;
      }
      const delBtns = Array.from(section.querySelectorAll('button,[role="button"]'))
        .filter(b=>{
          const t=clean(b.textContent).toLowerCase();
          const ar=(b.getAttribute('aria-label')||'').toLowerCase();
          return t==='x'||t==='×'||ar.includes('delete')||ar==='del'||ar==='remove';
        });
      const out=[];
      for(const d of delBtns){
        const row = d.closest('tr,li,.row,.budget-row,.itm-row,[class*="row"],[class*="grid"],div');
        if(!row || row.offsetParent===null) continue;
        const month = valueFrom(row.querySelector('input[placeholder*="$" i], input[aria-label*="monthly" i], input[name*="month" i], [contenteditable="true"], [data-amount]'));
        if(month<=0) continue;
        out.push({ name: extractNameFromRow(row), month });
      }
      return out;
    }
    function getItemizedFromStorage(){
      const keys=['va.expenses.rows','planner.itemized.rows','itemizedMonthlyBudget'];
      for(const k of keys){
        try{
          const raw = localStorage.getItem(k);
          if(!raw) continue;
          const arr = JSON.parse(raw)||[];
          const rows = arr.map(r=>({name:String(r.name||r.item||r.label||'Item'), month:Number(r.month||r.monthly||r.amount||r.value||0)||0}))
                          .filter(r=>r.month>0);
          if(rows.length) return rows;
        }catch(e){}
      }
      return [];
    }
    function getItemizedRows(){
      const domRows = getItemizedFromDOM();
      return domRows.length ? domRows : getItemizedFromStorage();
    }
    /* ---------- labelize (fallback names if missing) ---------- */
    const FALLBACK_LABELS = ['Rent','Groceries','Dining','Utilities','Insurance','Transportation','Internet/Phone','Subscriptions','Other'];
    function labelize(rows){
      if(!rows.length) return rows;
      const badCount = rows.filter(r=>!r.name || /^item$/i.test(r.name.trim())).length;
      if(badCount / rows.length >= 0.6){
        const sorted = [...rows].sort((a,b)=>b.month-a.month);
        for(let i=0;i<sorted.length;i++){
          const label = FALLBACK_LABELS[Math.min(i, FALLBACK_LABELS.length-1)];
          sorted[i].name = label;
        }
        return sorted;
      }
      return rows;
    }
    /* ---------- charts ---------- */
    let pieChart=null, barChart=null;
    function destroyIfExists(id){ const ex = window.Chart && Chart.getChart(id); if (ex) ex.destroy(); }
    function initCharts(){
      destroyIfExists('fid-pie'); destroyIfExists('fid-bars');
      if(pieChart){ pieChart.destroy(); pieChart=null; }
      if(barChart){ barChart.destroy(); barChart=null; }
      pieChart = new Chart(document.getElementById('fid-pie').getContext('2d'),{
        type:'doughnut',
        data:{ labels:['Expenses','Savings','Housing','Disposable'],
          datasets:[{ data:[0,0,0,1], backgroundColor:['#6aa7ff','#8ef3c5','#f9c74f','#55d399'] }] },
        options:{ plugins:{ legend:{ labels:{ color:'#cfd5ff' } } }, cutout:'62%', responsive:true, maintainAspectRatio:false }
      });
      barChart = new Chart(document.getElementById('fid-bars').getContext('2d'),{
        type:'bar',
        data:{ labels:[], datasets:[{ label:'Monthly $', data:[], backgroundColor:'#7de9bd' }] },
        options:{
          indexAxis:'y',
          plugins:{ legend:{ labels:{ color:'#cfd5ff' } }, tooltip:{ callbacks:{ label:(ctx)=> cur(ctx.raw) } } },
          scales:{ x:{ ticks:{ color:'#cfd5ff' } }, y:{ ticks:{ color:'#cfd5ff' } } },
          responsive:true, maintainAspectRatio:false
        }
      });
      // keep charts perfectly sized with container using ResizeObserver
      const holders = document.querySelectorAll('#fid-snapshot .chart-holder');
      const ro = new ResizeObserver(()=>{ pieChart?.resize(); barChart?.resize(); });
      holders.forEach(h=> ro.observe(h));
    }
    function updateItemizedBars(){
      if(!barChart) return;
      let rows = getItemizedRows();
      rows = labelize(rows);
      if(!rows.length){
        const s = snapshot();
        rows = [
          ['Rent', s.housing],
          ['Groceries',       Math.round(s.expenses*0.28)],
          ['Dining',          Math.round(s.expenses*0.17)],
          ['Utilities',       Math.round(s.expenses*0.12)],
          ['Insurance',       Math.round(s.expenses*0.10)],
          ['Transportation',  Math.round(s.expenses*0.15)],
          ['Internet/Phone',  Math.round(s.expenses*0.10)],
          ['Subscriptions',   Math.round(s.expenses*0.08)]
        ].filter(([_,v])=>v>0).map(([n,v])=>({name:n,month:v}));
      }
      rows.sort((a,b)=> b.month - a.month);
      const top = rows.slice(0,8);
      const rest = rows.slice(8);
      const other = rest.reduce((m,r)=>m+r.month,0);
      barChart.data.labels = top.map(r=>r.name).concat(other>0?['Other']:[]);
      barChart.data.datasets[0].data = top.map(r=>r.month).concat(other>0?[other]:[]);
      barChart.update();
    }
    function updateCharts(s){
      if(!pieChart || !barChart) return;
      pieChart.data.datasets[0].data = [s.expenses, s.savings, s.housing, Math.max(0,s.freePost)];
      pieChart.update();
      updateItemizedBars();
    }
    /* ---------- KPIs & lock ---------- */
    function localGrade(s){
      let g=92;
      if(s.totalShare>=0.85) g-=30; else if(s.totalShare>=0.70) g-=15; else g+=4;
      if(s.housingShare>0.40) g-=18; else if(s.housingShare>0.33) g-=8; else g+=4;
      if(s.freePost<0) g-=30; else if((s.freePost/s.income)<0.10) g-=10; else if((s.freePost/s.income)>=0.20) g+=4;
      const sr=s.savings/(s.income||1); if(sr<0.10) g-=8; else if(sr>=0.20) g+=4;
      if(s.score>=760) g+=3; else if(s.score<640) g-=12; else if(s.score<620) g-=18;
      if(s.ltv>0.95) g-=14; else if(s.ltv>0.80) g-=6; else g+=3;
      g=Math.max(0,Math.min(100,g));
      const letter = g>=98?'A+': g>=92?'A': g>=88?'A-'
                   : g>=82?'B+': g>=76?'B': g>=72?'B-'
                   : g>=66?'C+': g>=60?'C': g>=55?'C-'
                   : g>=50?'D+': g>=45?'D':'F';
      return {g,letter};
    }
    /* ---------- Elena: benchmarked, explanatory, sassy guidance ---------- */
    function buildElena(s){
      const sr = s.income>0 ? s.savings/s.income : 0;
      const buffer = s.income>0 ? s.freePost/s.income : 0;
      // Targets (industry-ish guardrails, friendly tone)
      const targets = {
        housingMax: 0.31,            // classic "front-end" ratio comfort line ~28–31%
        dtiMax:     0.43,            // many lenders cap around 43% back-end ratio
        saveMin:    0.20,            // “Ivy” stretch target
        bufferMin:  0.15,            // post-housing disposable >=15% income
        ltvGoal:    0.80,            // remove PMI/refi threshold
      };
      const good=[], watch=[], risks=[], actions=[];
      const why = (msg)=> `— ${msg}`;
      // Housing
      if (s.housingShare <= targets.housingMax) {
        good.push(`Housing at ${pct(s.housingShare,0)} ${why('inside the preferred ≤31% band lenders smile at.')}`);
      } else {
        watch.push(`Housing at ${pct(s.housingShare,0)} ${why('above comfort. Each +5% squeezes savings and buffer quickly.')}`);
        actions.push(`Test a lower price band or nudge down payment +2–5% to drop ${pct(s.housingShare,0)} closer to ≤31%.`);
      }
      // DTI
      if (s.dti <= 0.36) {
        good.push(`DTI ${pct(s.dti,0)} ${why('healthy. Underwriting feels easy at ≤36%.')}`);
      } else if (s.dti <= targets.dtiMax) {
        watch.push(`DTI ${pct(s.dti,0)} ${why('workable but tight. Above ~43% many lenders pull back.')}`);
        actions.push(`Trim recurring debts or refinance a high-APR card before locking — even a $100/mo drop helps approvals.`);
      } else {
        risks.push(`DTI ${pct(s.dti,0)} ${why('beyond typical approval lanes. You’ll face denials or higher rates.')}`);
        actions.push(`Defer purchase, reduce price, or pay down revolving balances to push DTI below 43% first.`);
      }
      // Savings cadence
      if (sr >= 0.20) {
        good.push(`Savings rate ${pct(sr,0)} ${why('on Ivy standard — compounding loves this.')}`);
      } else if (sr >= 0.12) {
        watch.push(`Savings ${pct(sr,0)} ${why('decent, but stretch to 20% during home search if possible.')}`);
        actions.push(`Auto-raise transfers by +5% of income while shopping; park in HYSA as rate hedge.`);
      } else {
        risks.push(`Savings ${pct(sr,0)} ${why('low — thin cushion for repairs/move-in variability.')}`);
        actions.push(`Set a pre-close sprint: +8–10% to savings for 3–4 months; re-cut discretionary categories.`);
      }
      // Buffer after housing
      if (buffer >= targets.bufferMin) {
        good.push(`Post-housing buffer ${pct(buffer,0)} (${cur(s.freePost)}) ${why('gives flexibility and safety.')}`);
      } else if (buffer > 0) {
        watch.push(`Post-housing buffer ${pct(buffer,0)} (${cur(s.freePost)}) ${why('lean — any surprise will hurt savings.')}`);
        actions.push(`Aim for ≥15% buffer by shaving non-essentials or lowering housing $${Math.round(Math.max(0, (targets.bufferMin-buffer)*s.income))}/mo.`);
      } else {
        risks.push(`Negative after housing (${cur(s.freePost)}) ${why('not sustainable without tapping credit.')}`);
        actions.push(`Reduce target payment or wait and rebuild buffer before proceeding.`);
      }
      // Credit → APR
      const aprText = (s.apr||s.inferredAPR).toFixed(2)+'%';
      if (s.score >= 740) {
        good.push(`Score ${s.score} → competitive APR territory (~${aprText}).`);
      } else if (s.score >= 700) {
        watch.push(`Score ${s.score} → ~${aprText}. Quarter-point improvement saves about ${cur(pmti(s.loan, (0.25/100)/12, s.termY*12),0)}/mo.`);
        actions.push(`Lower utilization to <10% on revolving lines for 30 days, then re-pull rate quotes.`);
      } else {
        risks.push(`Score ${s.score} → higher APR (~${aprText}).`);
        actions.push(`Dispute any bureau errors, avoid new pulls, use rapid-rescore after utilization drop for rate relief.`);
      }
      // LTV / PMI
      if (s.ltv > 0.80) {
        watch.push(`LTV ${pct(s.ltv,0)} with PMI likely.`);
        actions.push(`Plan a refi or PMI removal once value/equity pushes you to ≤80% LTV — target timeline 18–30 months.`);
      } else {
        good.push(`LTV ${pct(s.ltv,0)} — strong equity start.`);
      }
      // Compose Elena’s voice
      const intro = `Here’s your quick Ivy review, sweetheart — straight from “Elena” at the big mahogany table:`;
      const targetsLine = `At-a-glance targets • Housing ≤31% • DTI ≤36% (hard cap ≈43%) • Savings ≥20% • Buffer ≥15% • LTV ≤80% (ditch PMI).`;
      const bullets = [
        good.length?`✅ What’s working:\n${good.map(x=>`— ${x}`).join('\n')}`:'',
        watch.length?`⚠️ Keep an eye on:\n${watch.map(x=>`— ${x}`).join('\n')}`:'',
        risks.length?`❌ Red flags:\n${risks.map(x=>`— ${x}`).join('\n')}`:'',
        actions.length?`🛠️ Knobs that move the needle:\n${actions.map(x=>`— ${x}`).join('\n')}`:''
      ].filter(Boolean);
      return [intro, targetsLine, ...bullets];
    }
    function localAssumptions(s){
      return [
        `P&I from loan ${cur(s.loan)} at ${(s.apr||s.inferredAPR).toFixed(2)}% for ${s.termY} yrs.`,
        `Taxes/Insurance/HOA entered by you: ${cur(s.tihoa)}/mo.`,
        `PMI entered by you: ${cur(s.pmi)}/mo.`,
        `Down payment ${(s.dpPct*100).toFixed(0)}% → ${cur(s.dpAmt)}; LTV ${(s.ltv*100).toFixed(0)}%.`,
        `Ratios — Housing ${pct(s.housingShare)}, Total ${pct(s.totalShare)}, DTI ${pct(s.dti)}.`
      ];
    }
    /* ---------- paint & lock ---------- */
    function paintTop(){
      const s=snapshot();
      const after=$('#k-after');
      after.textContent = s.freePost>=0 ? cur(s.freePost) : ('-'+cur(Math.abs(s.freePost)));
      after.className = s.freePost<0 ? 'bad' : ((s.freePost/s.income)>=0.20 ? 'good' : ((s.freePost/s.income)>=0.10 ? 'warn' : 'neutral'));
      $('#k-hshare').textContent = pct(s.housingShare,0);
      $('#k-tshare').textContent = pct(s.totalShare,0);
      $('#k-dti').textContent    = pct(s.dti,0);
      $('#k-ltv').textContent    = pct(s.ltv,0);
      const score = Number(document.getElementById('cs-slider')?.value)||720;
      const aprUsed = Number(document.getElementById('h-rate')?.value) || scoreAPR(score);
      $('#k-score').textContent  = `${score} → ${aprUsed.toFixed(2)}%`;
      const g = localGrade({...s,score});
      $('#fid-grade').textContent = `${g.letter} • snapshot`;
      $('#fid-dot').style.background = (g.letter[0]==='A'||g.letter[0]==='B')?'#55d399':(g.letter[0]==='C'?'#f9c74f':'#ff6b6b');
      updateCharts(s);
      return s;
    }
    function locked(){
      const entered = onlyDigits(($('#fid-key').value||'').trim());
      return entered !== UNLOCK_KEY_NUM;
    }
    function renderLockedState(){
      const isLocked = locked();
      const root = document.getElementById('fid-snapshot');
      if (isLocked) root.classList.remove('unlocked'); else root.classList.add('unlocked');
      if(isLocked){ $('#fid-grade').textContent='Locked'; $('#fid-dot').style.background='#888'; }
    }
    /* ---------- wires ---------- */
    ['in-total','in-addl','ex-core','ex-disc','save-rate','cs-slider','h-price','dp-slider','h-rate','h-term','h-tihoa','h-pmi']
      .forEach(id=>{
        const n=document.getElementById(id);
        if(n){ n.addEventListener('input', ()=>{
          const s=paintTop();
          if(!locked()){
            const el = buildElena(s);
            $('#fid-guidance').innerHTML = '<div style="white-space:pre-line; line-height:1.5">'+el.join('\n\n')+'</div>';
            $('#fid-assump').innerHTML   = '<ul style="margin:8px 0 0 18px">'+localAssumptions(s).map(x=>`<li style="margin:6px 0">${x}</li>`).join('')+'</ul>';
          }
        });}
      });
    $('#fid-key').addEventListener('input', ()=>{
      const s=paintTop();
      const el = buildElena(s);
      $('#fid-guidance').innerHTML = '<div style="white-space:pre-line; line-height:1.5">'+el.join('\n\n')+'</div>';
      $('#fid-assump').innerHTML   = '<ul style="margin:8px 0 0 18px)">'+localAssumptions(s).map(x=>`<li style="margin:6px 0">${x}</li>`).join('')+'</ul>';
      renderLockedState();
    });
    // re-render bars when itemized rows change
    let __debounce;
    document.addEventListener('input', (e)=>{
      const t=e.target;
      if(!(t instanceof HTMLInputElement || t instanceof HTMLTextAreaElement)) return;
      const ph=(t.placeholder||'').toLowerCase();
      const ar=(t.getAttribute('aria-label')||'').toLowerCase();
      const nm=(t.name||'').toLowerCase();
      if(!(ph.includes('monthly')||ph.includes('name')||ar.includes('monthly')||ar.includes('name')||/month|amount|item/.test(nm))) return;
      clearTimeout(__debounce);
      __debounce = setTimeout(updateItemizedBars, 200);
    });
    window.addEventListener('storage', (ev)=>{
      if(['va.expenses.rows','planner.itemized.rows','itemizedMonthlyBudget'].includes(ev.key)) updateItemizedBars();
    });
    /* ---------- first mount ---------- */
    initCharts();
    const s0 = paintTop();
    const el = buildElena(s0);
    $('#fid-guidance').innerHTML = '<div style="white-space:pre-line; line-height:1.5">'+el.join('\n\n')+'</div>';
    $('#fid-assump').innerHTML   = '<ul style="margin:8px 0 0 18px)">'+localAssumptions(s0).map(x=>`<li style="margin:6px 0">${x}</li>`).join('')+'</ul>';
    renderLockedState();
    updateItemizedBars();
  })();
  </script>
                    </div>
                  </div>
                </section>
              </div>
            </div>
          </div>
        </section>
      </section>
    </section>
  </section>
  <section class="section section-57">
    <div class="destinations-container w-container">
      <div class="footer-wrapper">
        <div class="footer-text-wrapper">
          <div data-w-id="bc523ac8-e1fd-ae1a-5bc9-8dd4592ebf22" class="footer-flex-wrapper">
            <div class="footer-content-wrapper">
              <a href="#" class="footer-logo-link w-inline-block">
                <div class="logo-footer-wrapper"><img src="../images/quote.png" loading="lazy" sizes="(max-width: 767px) 100vw, (max-width: 991px) 95vw, 864.00390625px" srcset="../images/cadde6b11c41871bcfcaa77aebe5fbb7_quote-p-500.png 500w, ../images/cadde6b11c41871bcfcaa77aebe5fbb7_quote-p-800.png 800w, ../images/quote.png 864w" alt="quote icon" class="logo-image half-size">
                  <div>
                    <h4 class="logo-text">Orozco</h4>
                    <h6 class="logo-text-small">Realty</h6>
                  </div>
                </div>
              </a>
              <div class="space-text"></div>
              <p class="footer-paragraph">Our portfolio includes exquisite properties nestled in prime locations renowned for their desirability.</p>
              <div class="footer-social-links-wrapper invert">
                <a href="https://www.instagram.com/" target="_blank" class="footer-social-link w-inline-block"><img src="../images/instagram-black_1instagram-black.webp" loading="lazy" width="108" alt="Instagram Icon Image Black" class="footer-social-link-image"></a>
                <a href="https://facebook.com/" target="_blank" class="footer-social-link w-inline-block"><img src="../images/facebook-black_1facebook-black.webp" loading="lazy" alt="facebook icon black" class="footer-social-link-image"></a>
                <a href="https://www.twitter.com/" target="_blank" class="footer-social-link w-inline-block"><img src="../images/twitter.png" loading="lazy" sizes="(max-width: 767px) 100vw, 511.9921875px" srcset="../images/twitter-p-500.png 500w, ../images/twitter.png 512w" alt="" class="footer-social-link-image"></a>
                <a href="https://www.youtube.com/" target="_blank" class="footer-social-link w-inline-block"><img src="../images/youtube-black_1youtube-black.webp" loading="lazy" alt="YouTube White Icon Image Black" class="footer-social-link-image"></a>
              </div>
            </div>
            <div class="w-layout-grid footer-links-wrapper">
              <div class="footer-links-text">
                <div class="footer-links-title">Explore</div>
                <a href="../listings/listings.html" class="footer-link">Listings</a>
                <a href="#" class="footer-link">Realtors</a>
                <a href="#" class="footer-link">About US</a>
                <a href="../contact-us/contact-us-1.html" class="footer-link">Contact</a>
              </div>
              <div class="footer-links-text">
                <div class="footer-links-title">Utilities</div>
                <a href="#" class="footer-link">Ask Elena</a>
                <a href="../utilities/style-guide.html" class="footer-link">Realty SaSS</a>
                <a href="../utilities/instructions.html" class="footer-link">RE-Defined</a>
                <a href="../utilities/licenses.html" class="footer-link">Affordability Planner</a>
              </div>
              <div class="footer-links-text">
                <div class="footer-links-title">Contact</div>
                <p class="footer-text">          Las Vegas NV, 89101<br></p>
                <div class="flex-footer"><img src="../images/call_1call.webp" loading="lazy" alt="phone white icon" class="footer-icon">
                  <div class="footer-text">+(956) 337-9087</div>
                </div>
                <div class="flex-footer"><img src="../images/email-black_1email-black.webp" loading="lazy" alt="email black icon" class="footer-icon invert">
                  <div class="footer-text">josue@theorozcorealty.com</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="footer-bottom-wrapper">
          <div data-w-id="52f85444-b384-6205-3e76-8a80ab304cac" class="footer-bottom-flex">
            <div class="footer-text-flex">
              <p class="footer-bottom-text">© High-End Realty. All Rights Reserved.</p>
            </div>
            <div class="footer-text-flex">
              <p class="footer-bottom-text">Built by </p>
              <a href="https://yves-portfolio.webflow.io/" class="w-inline-block">
                <p class="footer-bottom-text">Josue Orozco</p>
              </a>
            </div>
            <div class="footer-text-flex">
              <p class="footer-bottom-text">Powered by </p>
              <a href="https://webflow.com/" class="w-inline-block">
                <p class="footer-bottom-text"> OrozcoRealty</p>
              </a>
            </div>
            <div class="footer-text-flex">
              <a href="../terms-conditions.html" class="w-inline-block">
                <p class="footer-bottom-text">Terms &amp; Conditions</p>
              </a>
            </div>
            <div class="footer-text-flex">
              <a href="../privacy-policy.html" class="w-inline-block">
                <p class="footer-bottom-text">Privacy Policy</p>
              </a>
            </div>
          </div>
        </div>
        <div class="font-styles w-embed">
          <style>
body {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}
</style>
        </div>
      </div>
    </div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=68ab0c767e65bfdde9efba3b" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script>
  <script>
(() => {
  // ---- 1) Correct endpoint (only line you’d change if you rename site) ----
  const API_BASE = "https://orozcorealty.netlify.app/api";
  // ---- 2) Helpers to read your existing inputs safely ----
  const $ = (q) => document.querySelector(q);
  const readNum = (el) => {
    if (!el) return 0;
    const v = (el.value || "").replace(/[^0-9.-]/g, "");
    const n = Number.parseFloat(v);
    return Number.isFinite(n) ? n : 0;
  };
  // Mortgage PMT
  function pmti(P, r, n) { if (r === 0) return P / n; const x = Math.pow(1 + r, n); return P * (r * x) / (x - 1); }
  // Build the payload from your current UI
  function buildPlannerSnapshot() {
    const income    = readNum($('#in-total')) + readNum($('#in-addl'));
    const exCore    = readNum($('#ex-core'));
    const exDisc    = readNum($('#ex-disc'));
    const saveRate  = Number($('#save-rate')?.value || 0) / 100;
    const price     = readNum($('#h-price'));
    const dpPct     = Number($('#dp-slider')?.value || 0) / 100;
    const dpAmt     = Math.max(0, price * dpPct);
    const loan      = Math.max(0, price - dpAmt);
    const apr       = Number($('#h-rate')?.value || 0);
    const termYears = Number($('#h-term')?.value || 30);
    const tihoa     = readNum($('#h-tihoa'));
    const pmi       = readNum($('#h-pmi'));
    const mRate     = apr / 100 / 12;
    const nMonths   = Math.max(1, termYears * 12);
    const pAndI     = loan > 0 ? pmti(loan, mRate, nMonths) : 0;
    const savings   = Math.max(0, income * saveRate);
    const housing   = pAndI + tihoa + pmi;
    const freePost  = income - exCore - exDisc - savings - housing;
    const totalShare= income > 0 ? (exCore + exDisc + savings + housing) / income : 0;
    const housingShare = income > 0 ? housing / income : 0;
    const dti       = income > 0 ? (exCore + exDisc + housing) / income : 0;
    const score     = Number($('#cs-slider')?.value || 720);
    return {
      income,
      addlIncome: readNum($('#in-addl')),
      exCore,
      exDisc,
      saveRatePct: Math.round(saveRate * 100),
      score,
      apr,
      price,
      dpPct: Math.round(dpPct * 100),
      dpAmt: Math.round(dpAmt),
      loan: Math.round(loan),
      termYears,
      tihoa,
      pmi,
      pAndI: Math.round(pAndI),
      housing: Math.round(housing),
      freePost: Math.round(freePost),
      totalSharePct: Math.round(totalShare * 100),
      housingSharePct: Math.round(housingShare * 100),
      dtiPct: Math.round(dti * 100)
    };
  }
  // Read the small “Tell us a bit about you” area
  function readUser() {
    const avatar = document.querySelector('input[name="avatar"]:checked')?.value || '';
    return {
      name:  $('#name')?.value?.trim() || '',
      email: $('#email')?.value?.trim() || '',
      avatar,
      status: $('#status')?.value || ''
    };
  }
  // ---- 3) POST to your Netlify function (correct endpoint) ----
  async function sendSnapshot() {
    const payload = {
      user: readUser(),
      planner: buildPlannerSnapshot(),
      activationCode: "956-337-9087"
    };
    const res = await fetch(`${API_BASE}/resend_snapshot`, {
      method: "POST",
      mode: "cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });
    if (!res.ok) {
      const t = await res.text().catch(() => "");
      throw new Error(`HTTP ${res.status} • ${t}`);
    }
    return res.json();
  }
  // ---- 4) Wire the button & status line ----
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('btn-activate'); // your blue button
    const msg = document.getElementById('send-msg');     // the small status span
    if (!btn || !msg) return;
    btn.addEventListener('click', async () => {
      msg.textContent = "Sending…";
      btn.disabled = true;
      try {
        await sendSnapshot();
        msg.textContent = "Sent! Check your email.";
      } catch (err) {
        console.error(err);
        msg.textContent = "Network error. Please try again.";
      } finally {
        btn.disabled = false;
      }
    });
  });
})();
</script>
</body>
</html>